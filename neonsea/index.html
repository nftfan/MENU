<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NFTFANS ERC1155 Shop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary: #60a5fa;
      --primary-dark: #2563eb;
      --bg: #10131a;
      --card-bg: #171c27;
      --radius: 11px;
      --shadow: 0 2px 12px rgba(30,58,138,0.09);
      --shadow-hover: 0 3px 14px rgba(30,58,138,0.14);
      --error: #e11d48;
      --desc: #b1b9d6;
      --border: #232a3a;
      --muted: #8892b0;
      --font-main: 'Inter', Arial, sans-serif;
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--primary);
      font-family: var(--font-main);
      min-height: 100vh;
      font-size: 14px;
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior: none;
    }
    .banner-wrap {
      width: 100vw; position: relative; margin-bottom: 0px;
      min-height: 80px;
      display: flex; justify-content: center; align-items: flex-start;
      background: var(--bg);
      border-bottom: 1.5px solid var(--border);
      overflow: hidden;
    }
    .banner-img {
      width: 100vw; max-height: 110px; object-fit: cover;
      display: block;
      filter: brightness(0.74) saturate(1.0) contrast(1.18);
      min-height: 90px;
      max-width: 100vw;
    }
    .banner-connect-btn {
      position: absolute; right: 11px; top: 13px;
      background: rgba(26, 33, 54, 0.98);
      border: 1.5px solid var(--primary);
      border-radius: 20px;
      color: var(--primary);
      font-weight: 600;
      font-size: 10px;
      padding: 5.5px 16px 5.5px 10px;
      box-shadow: var(--shadow);
      cursor: pointer;
      outline: none;
      transition: background .16s, border .18s, color .16s;
      z-index: 10;
      display: flex;
      align-items: center;
      gap: 4px;
      min-width: 0;
      max-width: 80vw;
      overflow: hidden;
    }
    .banner-connect-btn .material-icons { font-size: 1.13em; }
    .banner-connect-btn:hover { background: #232a3a; border: 1.5px solid var(--primary-dark); color: #fff; }
    .banner-connect-btn.connected {
      background: #222d42;
      color: #fff;
      border: 1.5px solid var(--primary);
    }
    .wrapper {
      max-width: 480px;
      margin: -19px auto 0 auto;
      padding: 0 4px 10px 4px;
      position: relative;
    }
    .status-bar {
      padding: 4px 8px;
      background: #fff;
      border-radius: 7px;
      margin: 10px 0 8px 0;
      font-size: 10px;
      color: var(--error) !important;
      display: flex; align-items: center; gap: 4px;
      box-shadow: var(--shadow);
      min-height: 22px;
      font-weight: 600;
      border: 1.5px solid #fff;
    }
    .material-icons.status-ic { font-size: 1.08em; color: var(--error); vertical-align: middle; }
    .tab-bar {
      display: flex; gap: 4px; margin-bottom: 9px;
      background: var(--card-bg);
      border-radius: 11px;
      box-shadow: var(--shadow);
      overflow: auto;
      padding: 3.5px 2.5px;
      justify-content: flex-start;
    }
    .tab-btn {
      flex: 1 1 0px;
      padding: 7px 0;
      background: none;
      border: none;
      outline: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 10px;
      color: var(--primary);
      cursor: pointer;
      transition: background 0.13s, color 0.13s;
      display: flex; align-items: center; justify-content: center; gap: 3px;
      letter-spacing: 0.01em;
      min-width: 0;
    }
    .tab-btn.active {
      background: linear-gradient(90deg, var(--primary-light) 0%, var(--primary-dark) 100%);
      color: #fff;
      box-shadow: var(--shadow);
    }
    .tab-btn:not(.active):hover {
      background: #232a3a;
      color: var(--primary);
    }
    .shop-grid, .recent-listings-grid, .nft-grid {
      list-style: none; padding: 0; margin: 0;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 7px 3.5px;
      justify-content: flex-start;
      align-items: stretch;
      width: 100%;
    }
    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 6px 4px 8px 6px;
      min-width: 0;
      text-align: left;
      transition: box-shadow .13s;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      position: relative;
      min-height: 145px;
      max-width: 100vw;
    }
    .card:hover { box-shadow: var(--shadow-hover); }
    .card-img {
      width: 100%;
      aspect-ratio: 1/1;
      min-height: 0; min-width: 0;
      object-fit: cover !important;
      border-radius: 7px;
      margin-bottom: 3px;
      background: #222d42;
      box-shadow: 0 0.5px 3px rgba(0,0,0,0.11);
      border: 1.2px solid #232a3a;
    }
    .card-title {
      font-size: 8.5px;
      font-weight: 700;
      margin: 1.5px 0 0.5px 0;
      color: var(--primary-light);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
      letter-spacing: 0.01em;
      text-align: left;
    }
    .card-id {
      font-size: 7.5px;
      color: var(--muted);
      margin-bottom: 0.5px;
      font-weight: 500;
      text-align: left;
    }
    .card-price {
      font-size: 8.5px;
      color: var(--primary);
      margin-bottom: 0.5px;
      font-weight: 600;
      display: flex; align-items: center; gap: 2px;
      text-align: left;
    }
    .sold-out, .recent-listing-amount, .inventory {
      font-size: 7.5px;
      font-weight: 600;
      color: var(--error);
      margin-bottom: 2.5px;
      text-align: left;
    }
    .sold-out { color: var(--error); }
    .inventory { color: #b1b9d6; font-weight: 400; }
    .listing-seller {
      font-size: 6.7px;
      color: var(--muted);
      margin-bottom: 2px;
      font-weight: 400;
      text-align: left;
      display: flex; align-items: center; gap: 2.5px;
    }
    .card-actions {
      width: 100%; display: flex; gap: 2.5px;
      justify-content: flex-start;
      margin-top: 2.5px;
    }
    .btn, .buy-btn, .sell-btn, .recent-listing-buy-btn {
      flex: 1 1 0;
      padding: 3.5px 0;
      background: linear-gradient(90deg, var(--primary-light) 0%, var(--primary-dark) 100%);
      border: none; border-radius: 5.5px;
      color: #fff;
      font-weight: 600;
      font-size: 8.5px;
      cursor: pointer;
      transition: background .15s, color .13s, box-shadow .13s;
      box-shadow: 0 0.5px 2.5px rgba(30,58,138,0.08);
      display: flex; align-items: center; justify-content: center; gap: 2.5px;
      min-width: 0;
      min-height: 20px;
    }
    .btn:disabled, .buy-btn:disabled, .sell-btn:disabled, .recent-listing-buy-btn:disabled {
      background: #232a3a; color: #7c899f; cursor: not-allowed; box-shadow: none;
    }
    .btn:not(:disabled):hover, .buy-btn:not(:disabled):hover, .sell-btn:not(:disabled):hover, .recent-listing-buy-btn:not(:disabled):hover {
      background: linear-gradient(90deg, var(--primary-dark) 0%, var(--primary-light) 100%);
      color: #fff;
    }
    .desc {
      font-size: 6.8px;
      color: var(--desc);
      font-weight: 400;
      margin-bottom: 1px;
      min-height: 13px;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      text-align: left;
    }
    .loading, .connect-required-msg {
      text-align: center;
      padding: 22px 0 12px 0;
      color: var(--primary-light);
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.01em;
      grid-column: 1/-1;
    }
    .error {
      background: #fff;
      color: var(--error);
      padding: 7px 10px;
      border-radius: 7px;
      margin-bottom: 8px;
      font-size: 8.5px;
      box-shadow: 0 1px 2.5px rgba(30,58,138,0.03);
      font-weight: 600;
      border: 1.5px solid #fff;
    }
    #sellModal {
      display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.5); justify-content: center; align-items: center;
    }
    #sellModalContent {
      background: var(--card-bg); padding: 21px 13px 13px 13px; border-radius: 11px; box-shadow: var(--shadow);
      min-width: 210px; max-width: 92vw; display: flex; flex-direction: column; align-items: center;
      font-size: 10px; gap: 2.3px; color: #fff;
    }
    #sellModalContent input {
      margin: 3.5px 0 7px 0; padding: 6px; border: 1px solid var(--primary-light); border-radius: 4.5px; width: 80%; font-size: 9px;
      background: #222d42;
      color: #fff;
      transition: border .14s;
    }
    #sellModalContent input:focus { border: 1.5px solid var(--primary); }
    #sellModalContent button {
      padding: 5.5px 13px; border-radius: 7px; border: none;
      background: linear-gradient(90deg, var(--primary-light) 0%, var(--primary-dark) 100%);
      color: #fff; font-weight: bold; cursor: pointer;
      margin-top: 4px;
      font-size: 9px;
    }
    #sellModalContent button:hover { background: linear-gradient(90deg, var(--primary-dark) 0%, var(--primary-light) 100%); }
    ::-webkit-scrollbar { width: 4px; background: #232a3a; }
    ::-webkit-scrollbar-thumb { background: #2a3452; border-radius: 8px; }
    ::selection { background: #dbeafe; }
    @media (max-width: 700px) {
      html, body { font-size: 11.7px; }
      .wrapper { max-width: 99vw; }
      .shop-grid, .recent-listings-grid, .nft-grid { gap: 5.5px 2px; }
      .card { min-height: 135px; }
    }
    @media (max-width: 425px) {
      html, body { font-size: 10.2px; }
      .wrapper { max-width: 100vw; }
      .status-bar { font-size: 8.2px; min-height: 19px;}
      .shop-grid, .recent-listings-grid, .nft-grid { gap: 3.5px 1.5px; }
      .card { min-height: 112px; }
      .tab-bar { padding: 2px; }
      .tab-btn { font-size: 8.7px; padding: 4.5px 0; }
    }
    @media (max-width: 340px) {
      html, body { font-size: 8px; }
      .banner-connect-btn { font-size: 8px; }
      .tab-btn { font-size: 7.2px; }
    }
  </style>
</head>
<body>
  <div class="banner-wrap">
    <img class="banner-img" src="https://pbs.twimg.com/media/Gs758wIWEAEsq45?format=jpg&name=large" alt="Banner">
    <button class="banner-connect-btn" id="connect-btn" onclick="connectWallet()">
      <span class="material-icons">account_balance_wallet</span>
      <span id="connect-btn-label">Connect Wallet</span>
    </button>
  </div>
  <div class="wrapper">
    <div class="status-bar" id="statusBar">
      <span class="material-icons status-ic">info</span>
      <span id="statusMsg">Connect your wallet to start...</span>
    </div>
    <div class="tab-bar">
      <button class="tab-btn active" id="tab-shop" onclick="showTab('shop')">
        <span class="material-icons">storefront</span> NFTFANS Shop
      </button>
      <button class="tab-btn" id="tab-recent" onclick="showTab('recent')">
        <span class="material-icons">bolt</span> Recently Listed
      </button>
      <button class="tab-btn" id="tab-mynfts" onclick="showTab('mynfts')">
        <span class="material-icons">collections</span> My NFTs
      </button>
    </div>
    <div class="tab-content" id="tab-content-shop">
      <div id="shop-loading" class="loading" style="display:none;">Loading NFTs...</div>
      <div id="shop-error" class="error" style="display: none;"></div>
      <div id="shop-connect-msg" class="connect-required-msg">Connect your wallet to start...</div>
      <ul class="shop-grid" id="shopGrid" style="display: none;"></ul>
    </div>
    <div class="tab-content" id="tab-content-recent" style="display:none;">
      <div id="recent-loading" class="loading" style="display:none;">Loading Recently Listed NFTs...</div>
      <div id="recent-error" class="error" style="display: none;"></div>
      <div id="recent-connect-msg" class="connect-required-msg">Connect your wallet to start...</div>
      <ul class="recent-listings-grid" id="recentListingsGrid" style="display: none;"></ul>
    </div>
    <div class="tab-content" id="tab-content-mynfts" style="display:none;">
      <div id="my-loading" class="loading" style="display:none;">Loading Your NFTs...</div>
      <div id="my-error" class="error" style="display: none;"></div>
      <div id="my-connect-msg" class="connect-required-msg">Connect your wallet to start...</div>
      <ul class="nft-grid" id="myGrid" style="display: none;"></ul>
    </div>
  </div>
  <div id="sellModal">
    <div id="sellModalContent">
      <h3 style="font-size:11px;margin:2px 0 7px 0;">Sell Your NFT</h3>
      <div style="font-size:9px;">Token ID: <span id="sellTokenId"></span></div>
      <div style="font-size:9px;">You own: <span id="sellMaxAmount"></span></div>
      <input type="number" id="sellAmountInput" min="1" placeholder="Amount to sell">
      <input type="number" id="sellPriceInput" step="0.000000000000000001" placeholder="Price per NFT (MATIC)">
      <div style="display:flex;gap:7px;width:100%;justify-content:center;">
        <button onclick="confirmSellNFT()"><span class='material-icons' style='font-size:1em;vertical-align:middle;'>sell</span> Sell</button>
        <button onclick="closeSellModal()" style="background:#d1d5db;color:#222;">Cancel</button>
      </div>
      <div id="sellModalError" style="color:#dc2626;margin-top:4px;font-size:8px;"></div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.8.0/web3.min.js"></script>
  <script>
    // --- CONTRACT CONSTANTS, see previous responses for full ABI if needed ---
    const NFTFAN_SHOP_ABI = [/* ... ABI ... */];
    const NFTFAN_SHOP_CA = "0x10FdffF7E02CDfB4E5d34FA5Dc93074f1F2619cc";
    const POLYGON_PARAMS = {
      chainId: '0x89',
      chainName: 'Polygon Mainnet',
      nativeCurrency: { name: 'MATIC', symbol: 'MATIC', decimals: 18 },
      rpcUrls: ['https://polygon-rpc.com/', 'https://rpc.polygon.technology/', 'https://rpc-mainnet.matic.network/'],
      blockExplorerUrls: ['https://polygonscan.com/'],
    };

    let userAccount = null;
    let web3, nftfanShop;

    function formatAddress(address) {
      if (!address) return '';
      return address.slice(0, 6) + '...' + address.slice(-4);
    }
    function updateStatus(message, icon = "info") {
      document.getElementById('statusMsg').textContent = message;
      document.querySelector('.status-ic').textContent = icon;
    }
    function showError(elementId, message) {
      const errorEl = document.getElementById(elementId);
      errorEl.textContent = message;
      errorEl.style.display = 'block';
    }
    function hideError(elementId) { document.getElementById(elementId).style.display = 'none'; }
    function setWalletConnectedUI(address) {
      const btn = document.getElementById("connect-btn");
      const label = document.getElementById("connect-btn-label");
      btn.classList.add("connected");
      label.textContent = formatAddress(address);
    }
    function setWalletDisconnectedUI() {
      const btn = document.getElementById("connect-btn");
      const label = document.getElementById("connect-btn-label");
      btn.classList.remove("connected");
      label.textContent = "Connect Wallet";
      localStorage.removeItem('nftfans_wallet_connected');
    }
    function showConnectRequired(tab) {
      if (tab === "shop") {
        document.getElementById("shopGrid").style.display = "none";
        document.getElementById("shop-loading").style.display = "none";
        document.getElementById("shop-connect-msg").style.display = "block";
      } else if (tab === "recent") {
        document.getElementById("recentListingsGrid").style.display = "none";
        document.getElementById("recent-loading").style.display = "none";
        document.getElementById("recent-connect-msg").style.display = "block";
      } else if (tab === "mynfts") {
        document.getElementById("myGrid").style.display = "none";
        document.getElementById("my-loading").style.display = "none";
        document.getElementById("my-connect-msg").style.display = "block";
      }
    }
    function hideConnectRequired(tab) {
      if (tab === "shop") document.getElementById("shop-connect-msg").style.display = "none";
      else if (tab === "recent") document.getElementById("recent-connect-msg").style.display = "none";
      else if (tab === "mynfts") document.getElementById("my-connect-msg").style.display = "none";
    }
    async function tryAutoConnect() {
      if (window.ethereum && localStorage.getItem('nftfans_wallet_connected') === '1') {
        try {
          const accounts = await window.ethereum.request({ method: 'eth_accounts' });
          if (accounts && accounts[0]) {
            userAccount = accounts[0];
            setWalletConnectedUI(accounts[0]);
            await setupContracts();
            showAppContent();
            return true;
          }
        } catch {}
      }
      showConnectRequired("shop");
      showConnectRequired("recent");
      showConnectRequired("mynfts");
      return false;
    }
    async function connectWallet() {
      try {
        updateStatus('Connecting wallet...', "account_balance_wallet");
        if (!window.ethereum) throw new Error("Please install MetaMask or a compatible wallet!");
        const chainId = await window.ethereum.request({ method: 'eth_chainId' });
        if (chainId !== POLYGON_PARAMS.chainId) {
          updateStatus('Switching to Polygon network...', "swap_horiz");
          try {
            await window.ethereum.request({
              method: 'wallet_switchEthereumChain',
              params: [{ chainId: POLYGON_PARAMS.chainId }],
            });
          } catch (switchError) {
            if (switchError.code === 4902) {
              await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [POLYGON_PARAMS],
              });
            } else { throw switchError; }
          }
        }
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        userAccount = accounts[0];
        localStorage.setItem('nftfans_wallet_connected', '1');
        setWalletConnectedUI(userAccount);
        await setupContracts();
        showAppContent();
      } catch (error) {
        updateStatus('Connection failed', "error");
        alert("Connection failed: " + error.message);
      }
    }
    function showAppContent() {
      hideConnectRequired("shop"); hideConnectRequired("recent"); hideConnectRequired("mynfts");
      loadShopNFTs(); loadUserNFTs(); loadRecentListings();
    }
    function setDisconnected() {
      userAccount = null;
      setWalletDisconnectedUI();
      showConnectRequired("shop");
      showConnectRequired("recent");
      showConnectRequired("mynfts");
    }
    async function setupContracts() {
      if (!web3) {
        const rpcUrls = POLYGON_PARAMS.rpcUrls;
        let provider = null;
        if (window.ethereum) provider = window.ethereum;
        else {
          for (const rpcUrl of rpcUrls) {
            try {
              const testWeb3 = new Web3(rpcUrl);
              await testWeb3.eth.getBlockNumber();
              provider = rpcUrl;
              break;
            } catch (e) {}
          }
        }
        if (!provider) throw new Error('No working RPC provider found');
        web3 = new Web3(provider);
      }
      nftfanShop = new web3.eth.Contract(NFTFAN_SHOP_ABI, NFTFAN_SHOP_CA);
    }
    async function fetchOpenSeaMeta(uri) {
      if (!uri) return null;
      try {
        if (uri.startsWith("ipfs://")) uri = "https://ipfs.io/ipfs/" + uri.replace("ipfs://", "");
        if (uri.startsWith("ar://")) uri = "https://arweave.net/" + uri.replace("ar://", "");
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 8000);
        const res = await fetch(uri, { mode: 'cors', signal: controller.signal });
        clearTimeout(timeoutId);
        if (!res.ok) throw new Error(`HTTP ${res.status}: ${res.statusText}`);
        return await res.json();
      } catch (e) { return null; }
    }
    async function loadShopNFTs() {
      if (!userAccount) return showConnectRequired("shop");
      const shopGrid = document.getElementById("shopGrid");
      const loading = document.getElementById("shop-loading");
      shopGrid.innerHTML = "";
      loading.style.display = "block";
      shopGrid.style.display = "none";
      hideError("shop-error");
      try {
        if (!nftfanShop) await setupContracts();
        const {ids, uris, prices, isForSale, shopAmounts, maxSupplies, currentSupplies} = await nftfanShop.methods.getShopNFTs().call();
        let html = "";
        let shown = 0;
        const metaArr = await Promise.all(uris.map(uri => fetchOpenSeaMeta(uri)));
        const allListings = await Promise.all(ids.map(id => nftfanShop.methods.getListings(id).call()));
        for (let i = 0; i < ids.length; i++) {
          const userListings = (allListings[i] || []).filter(l => l.amount && l.amount !== "0");
          if (
            !isForSale[i] ||
            shopAmounts[i] == "0" ||
            currentSupplies[i] !== maxSupplies[i] ||
            shopAmounts[i] !== maxSupplies[i] ||
            userListings.length > 0
          ) continue;
          shown++;
          const id = ids[i], meta = metaArr[i];
          const openseaName = meta?.name || `NFTFAN #${id}`;
          const openseaImg = meta?.image || uris[i] || "https://via.placeholder.com/110x110?text=NFT";
          const openseaDesc = meta?.description || "";
          const price = web3.utils.fromWei(prices[i], "ether");
          html += `<li class="card">
              <img class="card-img" src="${openseaImg}" alt="NFT ${openseaName}" onerror="this.src='https://via.placeholder.com/110x110?text=NFT'">
              <div class="card-title">${openseaName}</div>
              <div class="card-price"><span class="material-icons" style="font-size:1em;vertical-align:-1.5px;">paid</span> ${price} MATIC</div>
              <div class="card-id">ID: ${id}</div>
              ${openseaDesc ? `<div class="desc">${openseaDesc.substring(0, 34)}${openseaDesc.length > 34 ? '...' : ''}</div>` : ""}
              <div class="inventory">Available: ${shopAmounts[i]}</div>
              <div class="card-actions">
                <button class="buy-btn" onclick="buyNFT(${id}, '${prices[i]}', ${shopAmounts[i]})" ${!userAccount ? 'disabled' : ''}><span class='material-icons' style='font-size:1em;vertical-align:middle;'>shopping_cart</span> Buy</button>
              </div>
          </li>`;
        }
        if (shown === 0) {
          loading.textContent = "No new NFTs available in the shop.";
        } else {
          shopGrid.innerHTML = html;
          loading.style.display = "none";
          shopGrid.style.display = "grid";
        }
      } catch (error) {
        shopGrid.innerHTML = "";
        loading.style.display = "none";
        showError("shop-error", "Failed to load NFTs: " + error.message);
      }
    }
    // ... Fill in loadRecentListings, loadUserNFTs, confirmSellNFT, openSellModal, closeSellModal, buyNFT, etc. as previously provided ...
    // For brevity, these functions are omitted here but should be the same as in your previous code, just add the initial "if (!userAccount) return showConnectRequired(...);" guard at the top of each.

    function showTab(tab) {
      document.getElementById('tab-content-shop').style.display = 'none';
      document.getElementById('tab-content-mynfts').style.display = 'none';
      document.getElementById('tab-content-recent').style.display = 'none';
      document.getElementById(`tab-content-${tab}`).style.display = 'block';
      document.getElementById('tab-shop').classList.remove('active');
      document.getElementById('tab-mynfts').classList.remove('active');
      document.getElementById('tab-recent').classList.remove('active');
      document.getElementById(`tab-${tab}`).classList.add('active');
      if (!userAccount) {
        showConnectRequired(tab);
      } else {
        hideConnectRequired(tab);
        if (tab === 'shop') loadShopNFTs();
        else if (tab === 'recent') loadRecentListings();
        else if (tab === 'mynfts') loadUserNFTs();
      }
    }
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', function (accounts) {
        if (accounts && accounts[0]) {
          userAccount = accounts[0];
          setWalletConnectedUI(userAccount);
          localStorage.setItem('nftfans_wallet_connected', '1');
          setupContracts().then(() => {
            showAppContent();
          });
        } else {
          setDisconnected();
        }
      });
      window.ethereum.on('chainChanged', function () {
        setupContracts().then(() => {
          showAppContent();
        });
      });
    }
    window.addEventListener("DOMContentLoaded", async () => {
      updateStatus('Connect your wallet to start...', "info");
      await tryAutoConnect();
    });
    window.onclick = function(event) {
      const modal = document.getElementById("sellModal");
      if (event.target === modal) closeSellModal();
    };
  </script>
</body>
</html>
