<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AIR.FUN</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="CityUpdates">
  <link rel="apple-touch-icon" href="https://img.freepik.com/free-vector/blue-notification-bell-with-one-notification_78370-6899.jpg?semt=ais_hybrid&w=740">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
  :root {
  --bg-primary: #0a0b12;
  --bg-secondary: #12151f;
  --border-color: #2a2f45;
  --text-primary: #edf2ff;
  --text-secondary: #8e9cbb;
  --default-primary: #00ffd9;
  --default-secondary: rgba(0, 255, 217, 0.15);
  --default-bubble: #00ccad;
  --neon-pink: #ff2a6d;
  --neon-blue: #05d9e8;
  --neon-yellow: #ffd300;
  --anim-fast: 0.15s;
  --anim-normal: 0.25s;
  --anim-slow: 0.35s;
  --font-family: 'Rajdhani', 'Orbitron', 'Blade Runner', 'Share Tech Mono', monospace;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  background: var(--bg-primary);
  background-image: 
    linear-gradient(0deg, rgba(10, 11, 18, 0.9), rgba(10, 11, 18, 0.95)),
    url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%231e2436' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
  color: var(--text-primary);
  font-family: var(--font-family);
  font-size: 16px;
  -webkit-tap-highlight-color: transparent;
  overscroll-behavior: none;
  line-height: 1.6;
  text-shadow: 0 0 2px rgba(237, 242, 255, 0.4);
}

body {
  min-height: 100vh;
  box-sizing: border-box;
}

.container {
  width: 100vw;
  min-height: 100vh;
  max-width: 450px;
  margin: 0 auto;
  background: var(--bg-primary);
  background-image: linear-gradient(180deg, rgba(18, 21, 31, 0.8), rgba(10, 11, 18, 0.95));
  display: flex;
  flex-direction: column;
  min-height: 100svh;
  position: relative;
  box-shadow: 0 0 30px rgba(0, 255, 217, 0.15), 0 0 8px rgba(0, 255, 217, 0.08);
  border-left: 1px solid rgba(0, 255, 217, 0.15);
  border-right: 1px solid rgba(0, 255, 217, 0.15);
}

.header {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-start;
  padding: 18px 0 18px 0;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  gap: 12px;
  box-shadow: 0 2px 20px rgba(0, 255, 217, 0.08);
  position: sticky;
  top: 0;
  z-index: 10;
  background-image: linear-gradient(180deg, rgba(18, 21, 31, 0.95), rgba(18, 21, 31, 0.9));
}

.header .material-icons-round,
.header .icon {
  color: var(--default-primary);
  font-size: 24px;
  margin-left: 20px;
  margin-right: 4px;
  text-shadow: 0 0 8px var(--default-primary), 0 0 12px var(--default-primary);
  animation: neonPulse 4s infinite;
}

.header h1 {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--default-primary);
  margin: 0;
  letter-spacing: 1px;
  text-transform: uppercase;
  text-shadow: 0 0 8px var(--default-primary), 0 0 12px var(--default-primary);
  animation: neonPulse 4s infinite;
  background: linear-gradient(to right, var(--default-primary), var(--neon-blue), var(--default-primary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 200% auto;
  animation: textShine 6s linear infinite;
  font-family: 'Orbitron', 'Rajdhani', monospace;
}

@keyframes textShine {
  to {
    background-position: 200% center;
  }
}

.chatlist {
  flex: 1 1 auto;
  background: var(--bg-primary);
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 2px;
  overflow-y: auto;
  min-height: 150px;
  max-height: calc(100svh - 60px);
  scrollbar-width: thin;
  scrollbar-color: var(--default-primary) var(--border-color);
  background-image: repeating-linear-gradient(
    0deg,
    rgba(10, 11, 18, 0.97),
    rgba(10, 11, 18, 0.97) 4px,
    rgba(18, 21, 31, 0.97) 4px,
    rgba(18, 21, 31, 0.97) 8px
  );
}

.chatlist::-webkit-scrollbar {
  width: 4px;
}
.chatlist::-webkit-scrollbar-thumb {
  background: var(--default-primary);
  border-radius: 4px;
  box-shadow: 0 0 6px var(--default-primary);
}
.chatlist::-webkit-scrollbar-track {
  background: var(--border-color);
  border-radius: 4px;
}

.chat-entry {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid var(--border-color);
  gap: 14px;
  background: rgba(10, 11, 18, 0.6);
  cursor: pointer;
  transition: all var(--anim-fast) ease;
  position: relative;
  overflow: hidden;
  border-left: 3px solid var(--default-primary);
  backdrop-filter: blur(5px);
  box-shadow: inset 0 0 15px rgba(0, 255, 217, 0.05);
}

.chat-entry:before {
  content: '';
  position: absolute;
  top: 0;
  left: -50%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    to right,
    transparent,
    rgba(0, 255, 217, 0.1),
    transparent
  );
  transform: skewX(-25deg);
  transition: all 0.5s ease;
}

.chat-entry:hover:before {
  left: 150%;
  transition: all 0.7s ease;
}

.chat-entry:hover, .chat-entry:active {
  background: rgba(18, 21, 31, 0.8);
  box-shadow: 0 0 15px rgba(0, 255, 217, 0.15), inset 0 0 10px rgba(0, 255, 217, 0.05);
  border-left: 3px solid var(--neon-blue);
}

.chat-entry:after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 1px;
  background: linear-gradient(
    90deg,
    transparent,
    var(--default-primary),
    transparent
  );
  opacity: 0;
  transition: opacity 0.3s ease;
}

.chat-entry:hover:after {
  opacity: 0.6;
}

.chat-entry:active {
  transform: scale(0.98);
}

.chat-logo {
  width: 48px;
  height: 48px;
  border-radius: 4px;
  background: var(--default-secondary);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--default-primary);
  box-shadow: 0 0 10px rgba(0, 255, 217, 0.3), 0 0 20px rgba(0, 255, 217, 0.15);
  flex-shrink: 0;
  transition: all var(--anim-normal) ease;
  position: relative;
  background-image: linear-gradient(135deg, rgba(0, 255, 217, 0.12), rgba(5, 217, 232, 0.08));
}

.chat-entry:hover .chat-logo {
  transform: scale(1.05);
  box-shadow: 0 0 15px rgba(0, 255, 217, 0.4), 0 0 30px rgba(0, 255, 217, 0.2);
  border-color: var(--neon-blue);
}

.chat-logo:before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  border: 1px solid var(--default-primary);
  border-radius: 4px;
  animation: borderPulse 3s infinite;
  opacity: 0.6;
  z-index: -1;
}

@keyframes borderPulse {
  0%, 100% {
    box-shadow: 0 0 0px var(--default-primary);
  }
  50% {
    box-shadow: 0 0 10px var(--default-primary);
  }
}

.chat-logo img, .chat-logo svg, .chat-logo .icon {
  width: 100%;
  height: 100%;
  object-fit: contain;
  color: var(--default-primary);
  transition: transform var(--anim-fast) ease;
  filter: drop-shadow(0 0 2px var(--default-primary));
}

.chat-entry:active .chat-logo img {
  transform: scale(0.95);
}

.chat-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
  min-width: 0;
  flex: 1 1 0;
  position: relative;
}

.chat-name {
  font-size: 1.05rem;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  letter-spacing: 0.05em;
  transition: color var(--anim-fast) ease;
  color: var(--default-primary);
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
  text-transform: uppercase;
  
}

.chat-notify-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-left: 4px;
  box-shadow: 0 0 8px var(--default-primary), 0 0 12px var(--default-primary);
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: var(--default-primary);
  animation: pulseDot 2s infinite;
}

@keyframes pulseDot {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 8px var(--default-primary), 0 0 12px var(--default-primary);
  }
  50% {
    transform: scale(1.1);
    box-shadow: 0 0 12px var(--default-primary), 0 0 20px var(--default-primary);
  }
}

.chat-last-msg {
  font-size: 0.9rem;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.4;
  max-width: 260px;
  font-family: 'Share Tech Mono', monospace;
  opacity: 0.8;
}

.badge {
  position: absolute;
  top: 12px;
  right: 12px;
  min-width: 20px;
  height: 20px;
  border-radius: 2px;
  background: var(--default-primary);
  color: #111;
  font-size: 0.75rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 4px;
  box-shadow: 0 0 8px rgba(0, 255, 217, 0.4), 0 0 12px rgba(0, 255, 217, 0.2);
  animation: neonPulse 4s infinite;
  text-shadow: none;
}

@keyframes neonPulse {
  0%, 100% {
    box-shadow: 0 0 8px rgba(0, 255, 217, 0.4), 0 0 12px rgba(0, 255, 217, 0.2);
  }
  50% {
    box-shadow: 0 0 12px rgba(0, 255, 217, 0.5), 0 0 20px rgba(0, 255, 217, 0.3);
  }
}

.chatbox-overlay {
  position: fixed;
  inset: 0;
  background: rgba(10, 11, 18, 0.85);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 1000;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  animation: cyberpunkFadeIn var(--anim-normal) ease;
  background-image: linear-gradient(0deg, rgba(0, 255, 217, 0.03) 1px, transparent 1px),
                   linear-gradient(90deg, rgba(0, 255, 217, 0.03) 1px, transparent 1px);
  background-size: 30px 30px;
}

@keyframes cyberpunkFadeIn {
  0% { 
    opacity: 0;
    background-size: 20px 20px;
  }
  50% {
    background-size: 40px 40px;
  }
  100% { 
    opacity: 1; 
    background-size: 30px 30px;
  }
}

.chatbox {
  width: 100vw;
  max-width: 450px;
  background: var(--bg-primary);
  border-radius: 8px 8px 0 0;
  box-shadow: 0 -10px 40px rgba(0, 255, 217, 0.12), 0 0 20px rgba(0, 255, 217, 0.08);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  display: flex;
  flex-direction: column;
  max-height: 95vh;
  min-height: 380px;
  overflow: hidden;
  animation: cyberpunkSlideUp var(--anim-slow) cubic-bezier(0.16, 1, 0.3, 1);
  margin-bottom: 0;
  border: 1px solid var(--default-primary);
  background-image: linear-gradient(180deg, rgba(18, 21, 31, 0.95), rgba(10, 11, 18, 0.98));
  position: relative;
}

.chatbox:before {
  content: '';
  position: absolute;
  top: -1px;
  left: -1px;
  right: -1px;
  height: 2px;
  background: linear-gradient(to right, 
    transparent 0%,
    var(--neon-blue) 20%,
    var(--default-primary) 50%,
    var(--neon-blue) 80%,
    transparent 100%
  );
  z-index: 2;
  animation: scanline 4s linear infinite;
}

@keyframes scanline {
  0% {
    transform: translateX(-100%);
    opacity: 0;
  }
  10%, 90% {
    opacity: 1;
  }
  100% {
    transform: translateX(100%);
    opacity: 0;
  }
}

@keyframes cyberpunkSlideUp {
  0% { 
    transform: translateY(80px); 
    opacity: 0.7;
    box-shadow: 0 -5px 20px rgba(0, 255, 217, 0.05), 0 0 10px rgba(0, 255, 217, 0.04);
  }
  50% {
    box-shadow: 0 -15px 50px rgba(0, 255, 217, 0.15), 0 0 25px rgba(0, 255, 217, 0.1);
  }
  100% { 
    transform: translateY(0); 
    opacity: 1;
    box-shadow: 0 -10px 40px rgba(0, 255, 217, 0.12), 0 0 20px rgba(0, 255, 217, 0.08);
  }
}

.chatbox-header {
  display: flex;
  align-items: center;
  padding: 16px 16px 14px 16px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  gap: 14px;
  box-shadow: 0 2px 12px rgba(0, 255, 217, 0.06);
  border-top: 2px solid var(--default-primary);
  background-image: linear-gradient(180deg, rgba(18, 21, 31, 0.95), rgba(18, 21, 31, 0.9));
  position: relative;
}

.chatbox-header:after {
  content: '';
  position: absolute;
  left: 16px;
  right: 16px;
  bottom: -1px;
  height: 1px;
  background: linear-gradient(90deg, 
    transparent 0%,
    var(--default-primary) 50%,
    transparent 100%
  );
}

.chatbox-header .chat-logo {
  width: 40px;
  height: 40px;
  border-width: 1px;
  border-color: var(--default-primary);
  border-radius: 2px;
}

.chatbox-header .chatbox-title {
  font-size: 1.15rem;
  font-weight: 700;
  letter-spacing: 0.08em;
  color: var(--default-primary);
  text-transform: uppercase;
  text-shadow: 0 0 5px var(--default-primary);
  font-family: 'Orbitron', monospace;
}

.chatbox-header .close-btn {
  margin-left: auto;
  background: rgba(0, 255, 217, 0.08);
  border: none;
  border-radius: 4px;
  width: 36px;
  height: 36px;
  color: var(--default-primary);
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--anim-fast) ease;
  padding: 0;
  border: 1px solid rgba(0, 255, 217, 0.2);
  position: relative;
  overflow: hidden;
}

.chatbox-header .close-btn:after {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    to right,
    rgba(0, 255, 217, 0),
    rgba(0, 255, 217, 0.1),
    rgba(0, 255, 217, 0)
  );
  transform: rotate(45deg);
  animation: scanEffect 3s infinite;
  opacity: 0;
}

@keyframes scanEffect {
  0% {
    top: -50%;
    left: -50%;
    opacity: 0;
  }
  10%, 90% {
    opacity: 0.8;
  }
  100% {
    top: 150%;
    left: 150%;
    opacity: 0;
  }
}

.chatbox-header .close-btn:hover {
  background: rgba(0, 255, 217, 0.17);
  box-shadow: 0 0 10px rgba(0, 255, 217, 0.3), 0 0 20px rgba(0, 255, 217, 0.15);
}

.chatbox-header .close-btn:hover:after {
  opacity: 1;
}

.chatbox-messages {
  flex: 1 1 auto;
  overflow-y: auto;
  padding: 20px 16px;
  background: var(--bg-primary);
  display: flex;
  flex-direction: column;
  gap: 14px;
  scrollbar-width: thin;
  scrollbar-color: var(--default-primary) transparent;
  max-height: 60vh;
  min-height: 200px;
  height: 60vh;
  background-image: 
    linear-gradient(0deg, rgba(10, 11, 18, 0.95), rgba(10, 11, 18, 0.95)),
    repeating-linear-gradient(
      0deg,
      rgba(0, 255, 217, 0.02) 0px,
      rgba(0, 255, 217, 0.02) 1px,
      transparent 1px,
      transparent 4px
    );
  position: relative;
}

.chatbox-messages:before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: radial-gradient(
    circle at 30% 20%,
    rgba(0, 255, 217, 0.04) 0%,
    transparent 50%
  );
  pointer-events: none;
}

.chatbox-messages::-webkit-scrollbar {
  width: 4px;
}
.chatbox-messages::-webkit-scrollbar-thumb {
  background: var(--default-primary);
  border-radius: 2px;
  box-shadow: 0 0 6px var(--default-primary);
}
.chatbox-messages::-webkit-scrollbar-track {
  background: transparent;
}

.chatbox-message {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  border-radius: 4px;
  padding: 12px 16px;
  width: fit-content;
  max-width: 85%;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  font-size: 0.95rem;
  line-height: 1.5;
  word-break: break-word;
  animation: messageAppearCyberpunk var(--anim-normal) cubic-bezier(0.16, 1, 0.3, 1);
  transform-origin: bottom;
  font-family: 'Share Tech Mono', monospace;
  border: 1px solid;
  position: relative;
  overflow: hidden;
}

@keyframes messageAppearCyberpunk {
  0% {
    transform: translateY(20px) scale(0.95);
    opacity: 0;
    clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
  }
  30% {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }
  100% {
    transform: translateY(0) scale(1);
    opacity: 1;
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }
}

.chatbox-message.user-message {
  margin-left: auto;
  background: linear-gradient(135deg, rgba(0, 255, 217, 0.15), rgba(0, 255, 217, 0.05));
  color: var(--default-primary);
  border-bottom-right-radius: 0;
  flex-direction: row-reverse;
  border-color: rgba(0, 255, 217, 0.3);
  text-shadow: 0 0 2px rgba(0, 255, 217, 0.3);
  clip-path: polygon(
    0% 0%,
    100% 0%,
    100% calc(100% - 10px),
    calc(100% - 10px) 100%,
    0% 100%
  );
}

.chatbox-message.user-message:before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right, 
    transparent 0%,
    var(--default-primary) 50%,
    transparent 100%
  );
  opacity: 0.5;
}

.chatbox-message.bot-message {
  margin-right: auto;
  background: linear-gradient(135deg, rgba(5, 217, 232, 0.15), rgba(5, 217, 232, 0.05));
  color: var(--neon-blue);
  border-bottom-left-radius: 0;
  border-color: rgba(5, 217, 232, 0.3);
  text-shadow: 0 0 2px rgba(5, 217, 232, 0.3);
  clip-path: polygon(
    0% 0%,
    100% 0%,
    100% 100%,
    10px calc(100% - 0px),
    0 calc(100% - 10px)
  );
}

.chatbox-message.bot-message:before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right, 
    transparent 0%,
    var(--neon-blue) 50%,
    transparent 100%
  );
  opacity: 0.5;
}

.chatbox-message .chat-logo {
  display: none;
}

.typing-indicator {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px;
  animation: fadeIn var(--anim-normal) ease;
  margin-left: 20px;
}

.typing-dot {
  width: 6px;
  height: 6px;
  background-color: var(--default-primary);
  border-radius: 50%;
  animation: typingBounceCyberpunk 1.4s infinite ease-in-out;
  box-shadow: 0 0 8px var(--default-primary);
}

.typing-dot:nth-child(1) { animation-delay: 0s; }
.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes typingBounceCyberpunk {
  0%, 60%, 100% { 
    transform: translateY(0);
    box-shadow: 0 0 5px var(--default-primary);
  }
  30% { 
    transform: translateY(-4px);
    box-shadow: 0 0 10px var(--default-primary), 0 0 20px var(--default-primary);
  }
}

.chatbox-inputbar {
  display: flex;
  gap: 10px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  padding: 12px 16px;
  align-items: center;
  background-image: linear-gradient(0deg, rgba(18, 21, 31, 0.98), rgba(18, 21, 31, 0.95));
  position: relative;
}

.chatbox-inputbar:before {
  content: '';
  position: absolute;
  left: 16px;
  right: 16px;
  top: 0;
  height: 1px;
  background: linear-gradient(90deg, 
    transparent 0%,
    var(--default-primary) 50%,
    transparent 100%
  );
}

.chatbox-inputbar input {
  flex: 1 1 auto;
  border: none;
  border-radius: 4px;
  padding: 12px 16px;
  font-size: 0.95rem;
  background: rgba(10, 11, 18, 0.8);
  color: var(--text-primary);
  outline: none;
  transition: all var(--anim-fast) ease;
  box-shadow: 0 0 0 1px var(--border-color), inset 0 0 0 1px var(--border-color);
  font-family: 'Share Tech Mono', monospace;
  border: 1px solid var(--border-color);
  letter-spacing: 0.05em;
  caret-color: var(--default-primary);
}

.chatbox-inputbar input::placeholder {
  color: var(--text-secondary);
  opacity: 0.7;
}

.chatbox-inputbar input:focus {
  background: rgba(10, 11, 18, 0.9);
  box-shadow: 0 0 0 1px var(--default-primary), inset 0 0 0 1px var(--default-primary), 0 0 15px rgba(0, 255, 217, 0.15);
  border-color: var(--default-primary);
}

.chatbox-inputbar button {
  background: var(--default-primary);
  color: #051014;
  border: none;
  border-radius: 4px;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  font-weight: bold;
  cursor: pointer;
  transition: all var(--anim-fast) ease;
  box-shadow: 0 0 10px rgba(0, 255, 217, 0.3), 0 0 20px rgba(0, 255, 217, 0.15);
  position: relative;
  overflow: hidden;
}

.chatbox-inputbar button:before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255, 255, 255, 0.2),
    transparent
  );
  transition: all 0.6s ease;
}

.chatbox-inputbar button:hover:before {
  left: 100%;
}

.chatbox-inputbar button:hover {
  background: #00e6c2;
  box-shadow: 0 0 15px rgba(0, 255, 217, 0.4), 0 0 30px rgba(0, 255, 217, 0.2);
  text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
}

.chatbox-inputbar button:active {
  transform: scale(0.95);
  background: #00ccad;
  box-shadow: 0 0 8px rgba(0, 255, 217, 0.3), 0 0 16px rgba(0, 255, 217, 0.15);
}

.chatbox-inputbar .material-icons-round,
.chatbox-inputbar .icon {
  font-size: 20px;
}

.system-message {
  text-align: center;
  padding: 8px 16px;
  margin: 8px auto;
  color: var(--text-secondary);
  font-size: 0.85rem;
  background: rgba(10, 11, 18, 0.7);
  border-radius: 2px;
  max-width: 80%;
  animation: fadeInCyberpunk var(--anim-normal) ease;
  border: 1px solid rgba(0, 255, 217, 0.2);
  font-family: 'Share Tech Mono', monospace;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  box-shadow: 0 0 10px rgba(0, 255, 217, 0.1);
  position: relative;
  overflow: hidden;
}

.system-message:before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 200%;
  height: 1px;
  background: linear-gradient(to right, 
    transparent 0%,
    var(--default-primary) 50%,
    transparent 100%
  );
  animation: scanlineHorizontal 4s linear infinite;
}

@keyframes scanlineHorizontal {
  0% {
    transform: translateX(-50%);
    opacity: 0;
  }
  10%, 90% {
    opacity: 0.7;
  }
  100% {
    transform: translateX(50%);
    opacity: 0;
  }
}

@keyframes fadeInCyberpunk {
  0% {
    opacity: 0;
    transform: translateY(10px);
    clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }
}

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
  padding: 20px;
  color: var(--text-secondary);
  animation: fadeInCyberpunk var(--anim-slow) ease;
  background: linear-gradient(0deg, rgba(10, 11, 18, 0.8), rgba(10, 11, 18, 0.9));
  position: relative;
  overflow: hidden;
}

.empty-state:before {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  background: radial-gradient(circle at center, rgba(0, 255, 217, 0.03) 0%, transparent 70%);
  animation: pulseBackground 8s infinite ease;
}

@keyframes pulseBackground {
  0%, 100% {
    opacity: 0.3;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
}

.empty-state .material-icons-round,
.empty-state .icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.6;
  color: var(--default-primary);
  text-shadow: 0 0 10px var(--default-primary), 0 0 20px var(--default-primary);
  animation: neonPulse 4s infinite;
}

.empty-state h3 {
  font-size: 1.2rem;
  margin-bottom: 8px;
  color: var(--default-primary);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  font-family: 'Orbitron', monospace;
  text-shadow: 0 0 5px var(--default-primary);
}

.empty-state p {
  font-size: 0.9rem;
  max-width: 260px;
  margin: 0;
  line-height: 1.5;
  font-family: 'Share Tech Mono', monospace;
  position: relative;
  z-index: 1;
}

/* Glitch effect for messages */
.chatbox-message:hover:after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.03);
  opacity: 0;
  animation: glitchEffect 0.3s steps(2) forwards;
}

@keyframes glitchEffect {
  0%, 100% {
    opacity: 0;
    transform: translate(0);
  }
  20% {
    opacity: 0.3;
    transform: translate(-2px, 1px);
  }
  40% {
    opacity: 0.1;
    transform: translate(1px, -1px);
  }
  60% {
    opacity: 0.3;
    transform: translate(1px, 1px);
  }
  80% {
    opacity: 0.2;
    transform: translate(-1px, -1px);
  }
}

/* Circuit patterns on background */
.container:after {
  content: '';
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 20px;
  background-image: 
    linear-gradient(0deg, 
      transparent 10%, 
      rgba(0, 255, 217, 0.1) 50%,
      transparent 90%);
  pointer-events: none;
  opacity: 0.5;
}

/* Media queries */
@media (max-width: 450px) {
  html, body { font-size: 15px; }
  .container { max-width: 100vw; }
  .header { padding: 16px 0; }
  .header h1 { font-size: 1.1rem; }
  .chat-logo { width: 40px; height: 40px; }
  .chat-name { font-size: 0.95rem; }
  .chat-last-msg { font-size: 0.85rem; max-width: 220px; }
  .chatbox { max-width: 100vw; }
  .chatbox-header .chat-logo { width: 32px; height: 32px; }
  .chatbox-header .chatbox-title { font-size: 1rem; }
  .chatbox-message { font-size: 0.9rem; }
}

@media (max-width: 350px) {
  html, body { font-size: 14px; }
  .header h1 { font-size: 1rem; }
  .chat-logo { width: 36px; height: 36px; }
  .chat-last-msg { max-width: 180px; }
}

/* Custom scrollbar for cyberpunk look */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: rgba(18, 21, 31, 0.8); border-radius: 2px; }
::-webkit-scrollbar-thumb { 
  background: var(--default-primary); 
  border-radius: 2px; 
  box-shadow: 0 0 6px var(--default-primary);
}
::-webkit-scrollbar-thumb:hover { 
  background: #00e6c2; 
  box-shadow: 0 0 10px var(--default-primary), 0 0 15px rgba(0, 255, 217, 0.5);
}

/* Add vertical and horizontal grid lines */
.container:before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image:
    linear-gradient(to right, rgba(0, 255, 217, 0.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0, 255, 217, 0.05) 1px, transparent 1px);
  background-size: 20px 20px;
  pointer-events: none;
  opacity: 0.2;
  z-index: 0;
}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <span class="material-icons-round">mark_email_unread</span>
      <h1>AIR.FUN<span style="font-size:7px;">by NFTFANS</span></h1>
    </div>
    <div class="chatlist" id="chatlist"></div>
  </div>
  <div id="chatbox-overlay-root"></div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue, query, orderByChild } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
    const firebaseConfig = {
      apiKey: "AIzaSyD_c9jMxAA6dtyk_EXAHnH09OEAoalUADA",
      authDomain: "trackingclients.firebaseapp.com",
      projectId: "trackingclients",
      storageBucket: "trackingclients.appspot.com",
      messagingSenderId: "27490943622",
      appId: "1:27490943622:web:d6c87547aa5df440508707",
      databaseURL: "https://trackingclients-default-rtdb.firebaseio.com/"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Add more restaurants by adding to this array!
    const chats = [
      {
        name: "NFTFANS TOKEN",
        logo: "https://pbs.twimg.com/profile_images/1925011658151268352/M2ez5q8I_400x400.jpg",
        color: "#004dff"
      },
      {
        name: "COINFUN",
        logo: "https://pbs.twimg.com/media/GtAPA6qXEAA4du1?format=jpg&name=large",
        color: "#f364fa"
      },
      {
        name: "THRIVE PROTOCOL",
        logo: "https://pbs.twimg.com/profile_images/1838974918848897025/sulX6L3i_400x400.jpg",
        color: "#c4c6c7"
      },
      {
        name: "BITCOIN",
        logo: "https://pbs.twimg.com/profile_images/421692600446619648/dWAbC2wg_400x400.jpeg",
        color: "#fda81b"
      },
      {
        name: "SOLANA",
        logo: "https://pbs.twimg.com/profile_images/1472933274209107976/6u-LQfjG_400x400.jpg",
        color: "#1cf99a"
      },
      {
        name: "ETHEREUM",
        logo: "https://pbs.twimg.com/profile_images/1878738447067652096/tXQbWfpf_400x400.jpg",
        color: "#e8f1ff"
      },
      {
        name: "POLYGON",
        logo: "https://pbs.twimg.com/profile_images/1881552782148206592/uL2NdckM_400x400.jpg",
        color: "#fffeff"
      },
      {
        name: "PUMPFUN",
        logo: "https://pbs.twimg.com/profile_images/1748108741503803392/EmT4yP6S_400x400.jpg",
        color: "#52d38f"
      }
    ];

    let openChatIdx = null;
    let chatMessages = Array(chats.length).fill().map(() => []);
    let unreadCounts = Array(chats.length).fill(0);
    let riderUnreadDots = Array(chats.length).fill(false); // Track unread 'rider' messages for dot

    function listenForAllMessages() {
      chats.forEach((chat, idx) => {
        const chatName = chat.name;
        const chatRef = ref(db, `foodchat/${chatName}/messages`);
        onValue(query(chatRef, orderByChild('timestamp')), (snapshot) => {
          const msgs = [];
          snapshot.forEach(child => {
            const val = child.val();
            if (val && val.message) {
              msgs.push({
                message: val.message,
                sender: val.sender || "user",
                timestamp: val.timestamp || 0
              });
            }
          });
          chatMessages[idx] = msgs;

          // --- Rider notification dot logic ---
          // If there is at least one new 'rider' message that was not seen in this chat, show dot
          // Find last 'rider' message
          let lastRiderMsg = msgs.filter(m => m.sender === "rider").pop();
          // Track last seen timestamp per chat for 'rider' messages
          if (!window._lastSeenRider) window._lastSeenRider = Array(chats.length).fill(0);
          let lastSeen = window._lastSeenRider[idx] || 0;
          if (lastRiderMsg && lastRiderMsg.timestamp > lastSeen && openChatIdx !== idx) {
            riderUnreadDots[idx] = true;
          } else if (openChatIdx === idx) {
            riderUnreadDots[idx] = false;
            // Mark all as seen for this chat
            if (lastRiderMsg) window._lastSeenRider[idx] = lastRiderMsg.timestamp;
          }
          // --- End rider dot logic ---

          if (openChatIdx === null) renderChatList();
          if (openChatIdx === idx) renderChatBox(idx);
        });
      });
    }

    function renderChatList() {
      const chatlist = document.getElementById('chatlist');
      if (chatMessages.every(msgs => msgs.length === 0)) {
        chatlist.innerHTML = `
          <div class="empty-state">
            <span class="material-icons-round">chat_bubble_outline</span>
            <h3>No conversations yet</h3>
            <p>Start chatting with your favorite restaurants to place an order or get information.</p>
          </div>
        `;
        return;
      }
      chatlist.innerHTML = "";
      chats.forEach((chat, idx) => {
        let lastMsg = "<i>No messages yet</i>";
        let lastMsgTime = "";
        if (chatMessages[idx].length > 0) {
          const msgs = chatMessages[idx];

          // Find the latest message from rider (only rider is shown in chatbox now)
          let riderMsgs = msgs.filter(m => m.sender === "rider");
          let lastRiderMsg = riderMsgs.length > 0 ? riderMsgs[riderMsgs.length - 1] : null;

          let msgToShow = lastRiderMsg;

          // If no rider messages, fall back to last message
          if (!msgToShow) {
            msgToShow = msgs[msgs.length - 1];
          }

          if (msgToShow) {
            lastMsg = parseMessageWithLinks(msgToShow.message);
            if (msgToShow.timestamp) {
              const date = new Date(msgToShow.timestamp);
              lastMsgTime = formatTimestamp(date);
            }
          }
        }
        const badge = unreadCounts[idx] ? `<div class="badge" style="background:${chat.color};">${unreadCounts[idx]}</div>` : "";

        // --- Rider notification dot logic ---
        const notifyDot = riderUnreadDots[idx]
          ? `<span class="chat-notify-dot" style="background:${chat.color};"></span>`
          : "";
        // --- End dot logic ---

        const entry = document.createElement('div');
        entry.className = `chat-entry`;
        entry.style.borderLeftColor = chat.color;
        entry.innerHTML = `
          <div class="chat-logo" style="border-color:${chat.color}"><img src="${chat.logo}" alt="${chat.name} Logo"></div>
          <div class="chat-info">
            <div class="chat-name" style="color:${chat.color}">${chat.name} ${notifyDot}</div>
            <div class="chat-last-msg">${lastMsg}</div>
          </div>
          <div class="chat-time">${lastMsgTime}</div>
          ${badge}
        `;
        entry.onclick = () => openChat(idx);
        chatlist.appendChild(entry);
      });
    }

    function formatTimestamp(date) {
      const now = new Date();
      const diff = now - date;
      const isToday = date.toDateString() === now.toDateString();
      if (diff < 60000) {
        return "Just now";
      }
      if (diff < 3600000) {
        const minutes = Math.floor(diff / 60000);
        return `${minutes}m ago`;
      }
      if (isToday) {
        return date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      }
      if (diff < 604800000) {
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        return days[date.getDay()];
      }
      return date.toLocaleDateString([], {month: 'short', day: 'numeric'});
    }

    async function renderChatBox(idx) {
      if (typeof idx !== 'number') return;
      const root = document.getElementById('chatbox-overlay-root');
      const chat = chats[idx];
      const messages = chatMessages[idx];
      // Mark rider messages as seen, remove dot
      let lastRiderMsg = messages.filter(m => m.sender === "rider").pop();
      if (lastRiderMsg) {
        if (!window._lastSeenRider) window._lastSeenRider = Array(chats.length).fill(0);
        window._lastSeenRider[idx] = lastRiderMsg.timestamp;
      }
      riderUnreadDots[idx] = false;

      root.innerHTML = `
        <div class="chatbox-overlay" id="chatbox-overlay">
          <div class="chatbox">
            <div class="chatbox-header" style="border-top:4px solid ${chat.color}">
              <div class="chat-logo" style="border-color:${chat.color}"><img src="${chat.logo}" alt="${chat.name} Logo"></div>
              <span class="chatbox-title" style="color:${chat.color}">${chat.name}</span>
              <button class="close-btn" id="closeChatBtn" title="Close">
                <span class="material-icons-round">close</span>
              </button>
            </div>
            <div class="chatbox-messages" id="chatbox-messages">
              ${await renderMessages(messages, chat)}
            </div>
          </div>
        </div>
      `;
      setTimeout(() => {
        const msgArea = document.getElementById('chatbox-messages');
        if (msgArea) msgArea.scrollTop = msgArea.scrollHeight;
      }, 100);
      document.getElementById('closeChatBtn').onclick = closeChat;
      document.getElementById('chatbox-overlay').onclick = (e) => {
        if (e.target.id === 'chatbox-overlay') closeChat();
      };
    }

    // Utility to convert URLs in text to clickable links and embed previews (Twitter, YouTube, general link preview)
    function parseMessageWithLinks(text) {
      // Replace URLs with clickable links
      const urlRegex = /(https?:\/\/[^\s]+)/g;
      return text.replace(urlRegex, (url) => {
        if (isTweetURL(url)) {
          // Place a placeholder for tweet embed
          return `<div class="tweet-embed" data-url="${url}"><a href="${url}" target="_blank">${url}</a></div>`;
        }
        if (isYouTubeURL(url)) {
          const ytId = getYouTubeId(url);
          if (ytId)
            return `<div class="yt-embed"><iframe width="320" height="180" src="https://www.youtube.com/embed/${ytId}" frameborder="0" allowfullscreen></iframe></div>`;
        }
        // Generic link preview placeholder (will be enhanced later)
        return `<a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a>`;
      });
    }

    function isTweetURL(url) {
      return /^https?:\/\/(www\.)?twitter\.com\/[^\/]+\/status\/\d+/.test(url) ||
             /^https?:\/\/x\.com\/[^\/]+\/status\/\d+/.test(url);
    }
    function isYouTubeURL(url) {
      return /^https?:\/\/(www\.)?(youtube\.com|youtu\.be)\//.test(url);
    }
    function getYouTubeId(url) {
      const ytMatch = url.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/|v\/))([a-zA-Z0-9_-]{11})/);
      return ytMatch ? ytMatch[1] : null;
    }

    // If you want to support link previews (e.g., for news, websites), you need a backend or third party API.
    // Here, we just show a clickable link.

    // Render tweet embed using Twitter's widget.js
    function embedTweets(el) {
      if (!window.twttr) {
        // Dynamically load Twitter widgets.js
        const script = document.createElement("script");
        script.src = "https://platform.twitter.com/widgets.js";
        script.async = true;
        script.onload = () => {
          window.twttr.widgets.load(el);
        };
        document.body.appendChild(script);
      } else {
        window.twttr.widgets.load(el);
      }
    }

    async function renderMessages(messages, chat) {
      // Only show rider messages
      const riderMessages = messages ? messages.filter(msg => msg.sender === "rider") : [];
      if (!riderMessages || riderMessages.length === 0) {
        return `
          <div class="system-message">
            No messages from team yet.
          </div>
        `;
      }
      let output = '';
      let lastDate = null;
      let uniqueId = 0;
      riderMessages.forEach((msg, i) => {
        const msgDate = new Date(msg.timestamp || 0);
        if (msg.timestamp && (!lastDate || !isSameDay(lastDate, msgDate))) {
          output += `<div class="system-message">${formatDateHeader(msgDate)}</div>`;
          lastDate = msgDate;
        }
        let senderClass = "bot-message";
        let style = `background:${chat.color}22; color:var(--text-primary);`;
        const parsedMsg = parseMessageWithLinks(msg.message);
        const msgId = "msg-"+(uniqueId++);
        output += `
          <div class="chatbox-message ${senderClass}" style="animation-delay: ${i * 0.1}s;${style}" id="${msgId}">
            <div>${parsedMsg}</div>
          </div>
        `;
      });
      // After rendering, embed tweets if any
      setTimeout(() => {
        document.querySelectorAll('.tweet-embed').forEach(embedTweets);
      }, 150);
      return output;
    }

    function formatDateHeader(date) {
      const now = new Date();
      const yesterday = new Date(now);
      yesterday.setDate(now.getDate() - 1);
      if (isSameDay(date, now)) {
        return "Today";
      } else if (isSameDay(date, yesterday)) {
        return "Yesterday";
      } else {
        return date.toLocaleDateString([], {weekday: 'long', month: 'long', day: 'numeric'});
      }
    }
    function isSameDay(date1, date2) {
      return date1.getDate() === date2.getDate() && 
             date1.getMonth() === date2.getMonth() && 
             date1.getFullYear() === date2.getFullYear();
    }
    function openChat(idx) {
      openChatIdx = idx;
      unreadCounts[idx] = 0;
      // Mark all rider messages as seen
      if (!window._lastSeenRider) window._lastSeenRider = Array(chats.length).fill(0);
      let lastRiderMsg = chatMessages[idx].filter(m => m.sender === "rider").pop();
      if (lastRiderMsg) window._lastSeenRider[idx] = lastRiderMsg.timestamp;
      riderUnreadDots[idx] = false;
      renderChatBox(idx);
      renderChatList();
    }
    function closeChat() {
      openChatIdx = null;
      document.getElementById('chatbox-overlay-root').innerHTML = "";
      renderChatList();
    }
    listenForAllMessages();
    renderChatList();
  </script>
  <script>
// Replace with your Telegram Bot Token and Chat ID
const botToken = '7761334520:AAH2N1Ksa9NToLr6gd6DcknzpyB27q-_d14';
const chatId = '2141064153';

function sendNotification() {
    // Get the page title
    const pageTitle = document.title;

    // Fetch the user's IP address
    fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
            const userIP = data.ip; // Extract the IP address
            
            // Construct the message including the page title and IP address
            const message = `A user has opened the page: ${pageTitle}, IP Address: ${userIP}`;

            // Construct the Telegram API URL
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;

            // Send the notification to Telegram
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log('Notification sent successfully.');
                    } else {
                        console.error('Failed to send notification:', data);
                    }
                })
                .catch(error => console.error('Error:', error));
        })
        .catch(error => console.error('Failed to fetch IP address:', error));
}

// Attach event listener to DOMContentLoaded
document.addEventListener('DOMContentLoaded', function() {
    sendNotification();
});
</script>
</body>
</html>
