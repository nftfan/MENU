<!DOCTYPE html>
<html lang="en">
<head>

 <meta charset="UTF-8">
  <title>Personal Delivery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="icon" href="https://raw.githubusercontent.com/nftfan/delivery/main/Untitled%20design%20(22).png" type="image/png">
  
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Personal Delivery">
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/nftfan/delivery/main/Untitled%20design%20(23)929292.png">
  <link rel="apple-touch-startup-image" href="https://raw.githubusercontent.com/nftfan/delivery/main/Untitled%20design%20(22).png">
  <link rel="manifest" href="https://raw.githubusercontent.com/nftfan/delivery/main/d2.json">
  <meta charset="UTF-8">
  <title>MATIC Bank - Digital Wallet Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.8.0/web3.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
    }

    .background-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.1;
      background-image: radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),
                        radial-gradient(circle at 75% 75%, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 60px 60px;
      pointer-events: none;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 428px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      text-align: center;
      padding: 40px 0 30px;
      position: relative;
    }

    .bank-logo {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.9) 100%);
      border-radius: 18px;
      margin: 0 auto 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      animation: float 3s ease-in-out infinite;
    }

    .bank-logo::before {
      content: "₿";
      font-size: 28px;
      font-weight: bold;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
    }

    .bank-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.5px;
    }

    .bank-subtitle {
      font-size: 16px;
      opacity: 0.8;
      font-weight: 400;
    }

    .total-balance-card {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 32px 24px;
      margin-bottom: 32px;
      border: 1px solid rgba(255,255,255,0.2);
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      position: relative;
      overflow: hidden;
    }

    .total-balance-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    }

    .total-label {
      font-size: 14px;
      opacity: 0.7;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 500;
    }

    .total-amount {
      font-size: 42px;
      font-weight: 800;
      margin-bottom: 4px;
      letter-spacing: -1px;
    }

    .total-currency {
      font-size: 16px;
      opacity: 0.8;
      font-weight: 500;
    }

    .refresh-btn {
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 50px;
      color: #fff;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      margin: 0 auto 32px;
      display: block;
      min-width: 140px;
    }

    .refresh-btn:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .refresh-btn:active {
      transform: translateY(0);
    }

    .refresh-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .accounts-section {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      padding-left: 4px;
      opacity: 0.9;
    }

    .account-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 16px;
      border: 1px solid rgba(255,255,255,0.15);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .account-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.15);
      background: rgba(255,255,255,0.15);
    }

    .account-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }

    .account-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .account-name {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
    }

    .account-type {
      font-size: 12px;
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    .account-address {
      font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
      font-size: 12px;
      opacity: 0.7;
      background: rgba(0,0,0,0.1);
      padding: 8px 12px;
      border-radius: 12px;
      margin-bottom: 16px;
      word-break: break-all;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .balance-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .balance-info {
      flex: 1;
    }

    .balance-label {
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .balance-amount {
      font-size: 24px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 2px;
    }

    .balance-currency {
      font-size: 14px;
      opacity: 0.8;
    }

    .balance-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error-message {
      background: rgba(255, 71, 87, 0.15);
      border: 1px solid rgba(255, 71, 87, 0.3);
      color: #ff6b7a;
      padding: 12px 16px;
      border-radius: 12px;
      margin-top: 12px;
      font-size: 14px;
      backdrop-filter: blur(10px);
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    /* Enhanced mobile responsiveness */
    @media (max-width: 480px) {
      .container {
        padding: 16px;
      }
      
      .header {
        padding: 20px 0 20px;
      }
      
      .bank-title {
        font-size: 24px;
      }
      
      .total-amount {
        font-size: 36px;
      }
      
      .account-card {
        padding: 20px;
      }
      
      .balance-amount {
        font-size: 20px;
      }
    }

    /* Dark mode enhancements */
    @media (prefers-color-scheme: dark) {
      .account-address {
        background: rgba(255,255,255,0.05);
      }
    }
  </style>
</head>
<body>
  <div class="background-pattern"></div>
  
  <div class="container">
    <div class="header">
      <div class="bank-logo"></div>
      <h1 class="bank-title">MATIC Bank</h1>
      <p class="bank-subtitle">Digital Wallet Dashboard</p>
    </div>

    <div class="total-balance-card">
      <div class="total-label">Total Portfolio Value</div>
      <div class="total-amount" id="total-balance">
        <span class="loading-spinner"></span>
      </div>
      <div class="total-currency">MATIC</div>
    </div>

    <button class="refresh-btn" onclick="refreshAllBalances()" id="refresh-btn">
      🔄 Refresh Balances
    </button>

    <div class="accounts-section">
      <h2 class="section-title">Your Accounts</h2>
      
      <div class="account-card" id="account-1">
        <div class="account-header">
          <div class="account-name">NFTFAN SALE</div>
          <div class="account-type">Trading</div>
        </div>
        <div class="account-address">0xaf2d132c8773bca3821c24ecf64e844e202a12e8</div>
        <div class="balance-section">
          <div class="balance-info">
            <div class="balance-label">Available Balance</div>
            <div class="balance-amount" id="balance-1">
              <span class="loading-spinner"></span>
            </div>
            <div class="balance-currency">MATIC</div>
          </div>
          <div class="balance-icon">💎</div>
        </div>
        <div id="error-1"></div>
      </div>

      <div class="account-card" id="account-2">
        <div class="account-header">
          <div class="account-name">POLDOG SALE</div>
          <div class="account-type">Investment</div>
        </div>
        <div class="account-address">0xB1A37c277986E13Aa6c4f0763c2F06C4E9527D54</div>
        <div class="balance-section">
          <div class="balance-info">
            <div class="balance-label">Available Balance</div>
            <div class="balance-amount" id="balance-2">
              <span class="loading-spinner"></span>
            </div>
            <div class="balance-currency">MATIC</div>
          </div>
          <div class="balance-icon">🚀</div>
        </div>
        <div id="error-2"></div>
      </div>

      <div class="account-card" id="account-0">
        <div class="account-header">
          <div class="account-name">MY WALLET</div>
          <div class="account-type">Personal</div>
        </div>
        <div class="account-address">0x92d550cdBc234211957Bd1B579d962c885A127Ba</div>
        <div class="balance-section">
          <div class="balance-info">
            <div class="balance-label">Available Balance</div>
            <div class="balance-amount" id="balance-0">
              <span class="loading-spinner"></span>
            </div>
            <div class="balance-currency">MATIC</div>
          </div>
          <div class="balance-icon">👤</div>
        </div>
        <div id="error-0"></div>
      </div>
    </div>
  </div>

  <script>
    const POLYGON_RPC = "https://polygon-rpc.com/";
    const WALLETS = [
      { address: "0x92d550cdBc234211957Bd1B579d962c885A127Ba", box: "0" },
      { address: "0xaf2d132c8773bca3821c24ecf64e844e202a12e8", box: "1" },
      { address: "0xB1A37c277986E13Aa6c4f0763c2F06C4E9527D54", box: "2" }
    ];

    const DISPLAY_ORDER = [1, 2, 0];
    let totalBalance = 0;

    async function fetchAndShowBalance(wallet, idx) {
      try {
        document.getElementById("balance-" + idx).innerHTML = '<span class="loading-spinner"></span>';
        document.getElementById("error-" + idx).innerHTML = "";
        
        const web3 = new Web3(POLYGON_RPC);
        const balanceWei = await web3.eth.getBalance(wallet.address);
        const balance = web3.utils.fromWei(balanceWei, "ether");
        const formattedBalance = parseFloat(balance).toLocaleString(undefined, {maximumFractionDigits: 4});
        
        document.getElementById("balance-" + idx).textContent = formattedBalance;
        
        // Add to total balance
        totalBalance += parseFloat(balance);
        
        // Add pulse animation on update
        const card = document.getElementById("account-" + idx);
        card.classList.add("pulse");
        setTimeout(() => card.classList.remove("pulse"), 2000);
        
      } catch (err) {
        document.getElementById("balance-" + idx).innerHTML = "--";
        document.getElementById("error-" + idx).innerHTML = '<div class="error-message">⚠️ Failed to fetch balance<br><small>' + err.message + '</small></div>';
      }
    }

    function updateTotalBalance() {
      const totalFormatted = totalBalance.toLocaleString(undefined, {maximumFractionDigits: 4});
      document.getElementById("total-balance").textContent = totalFormatted;
    }

    async function refreshAllBalances() {
      const btn = document.getElementById("refresh-btn");
      btn.disabled = true;
      btn.innerHTML = "⏳ Refreshing...";
      
      // Reset total
      totalBalance = 0;
      document.getElementById("total-balance").innerHTML = '<span class="loading-spinner"></span>';
      
      try {
        await Promise.all(DISPLAY_ORDER.map(idx => fetchAndShowBalance(WALLETS[idx], idx)));
        updateTotalBalance();
      } finally {
        btn.disabled = false;
        btn.innerHTML = "🔄 Refresh Balances";
      }
    }

    // Auto-refresh every 30 seconds
    let autoRefreshInterval;
    
    function startAutoRefresh() {
      autoRefreshInterval = setInterval(refreshAllBalances, 30000);
    }
    
    function stopAutoRefresh() {
      if (autoRefreshInterval) {
        clearInterval(autoRefreshInterval);
      }
    }

    // Page visibility API to pause/resume auto-refresh
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) {
        stopAutoRefresh();
      } else {
        startAutoRefresh();
      }
    });

    // Initialize on page load
    window.addEventListener("DOMContentLoaded", () => {
      refreshAllBalances();
      startAutoRefresh();
    });

    // Cleanup on page unload
    window.addEventListener("beforeunload", stopAutoRefresh);
  </script>
</body>
</html>
