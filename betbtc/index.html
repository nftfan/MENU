<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BTC Predictor Pro</title>
<meta name="viewport" content="width=420">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
  --neon:#00ffff;
  --pink:#ff2fdc;
  --yellow:#FCD535;
  --bg:radial-gradient(circle at top,#0b1030,#05070d);
  --card:rgba(20,25,45,0.85);
  --green:#2eff9a;
  --red:#ff4d6d;
}

body{
  margin:0;
  padding:10px;
  background:var(--bg);
  font-family:Roboto,Arial;
  color:#EAECEF;
}

.container{
  max-width:380px;
  margin:auto;
  background:var(--card);
  border-radius:18px;
  padding:20px;
  border:1px solid rgba(0,255,255,0.2);
  box-shadow:0 0 30px rgba(0,255,255,0.15);
}

h1{
  text-align:center;
  font-size:1.2rem;
  text-shadow:0 0 12px var(--neon);
}

.btn{
  width:100%;
  padding:12px;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}

.btn-connect{
  background:linear-gradient(135deg,var(--neon),var(--pink));
  color:#000;
}

.btn-up{background:var(--green);color:#000;margin-bottom:8px;}
.btn-down{background:var(--red);color:#000;}
.btn-disabled{opacity:.3;pointer-events:none;}
.selected{outline:2px solid #fff;}

.banner{
  margin:12px 0;
  border-radius:10px;
  overflow:hidden;
  border:1px solid rgba(0,255,255,.3);
  box-shadow:0 0 18px rgba(0,255,255,.3);
}
.banner img{width:100%;display:block;}

.stats{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin:12px 0;
}

.card{
  background:rgba(0,0,0,.35);
  padding:10px;
  border-radius:8px;
  text-align:center;
  border:1px solid rgba(0,255,255,.15);
}

.label{font-size:9px;color:#aaa;}
.value{font-size:14px;font-weight:bold;}

#btc-price{
  text-align:center;
  font-size:26px;
  color:var(--yellow);
  margin:8px 0;
}

#timer{text-align:center;font-size:18px;color:var(--neon);}

.live-box{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
  font-size:12px;
}

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  align-items:center;
  justify-content:center;
  z-index:999;
}

.modal-content{
  background:var(--card);
  padding:24px;
  border-radius:16px;
  text-align:center;
  border:1px solid var(--neon);
}

.lb-item{
  display:flex;
  justify-content:space-between;
  background:#111;
  padding:8px;
  border-radius:6px;
  margin-bottom:4px;
  font-size:11px;
}
</style>
</head>

<body>

<div class="container">
<h1>BTC PREDICTOR PRO</h1>

<div id="auth-section">
  <button id="connectBtn" class="btn btn-connect">CONNECT WALLET</button>

  <!-- BANNER -->
  <div class="banner">
    <img src="https://i.postimg.cc/59CPJw8g/image.png">
  </div>
</div>

<div id="app-content" style="display:none">

<div class="stats">
  <div class="card">
    <div class="label">Balance (USD)</div>
    <div id="balanceUSD" class="value">$100.00</div>
  </div>
  <div class="card">
    <div class="label">Reward (NFTFAN)</div>
    <div id="rewardNFTFAN" class="value" style="color:var(--neon)">100M</div>
  </div>
</div>

<div id="btc-price">Loading...</div>
<canvas id="btcChart" height="80"></canvas>

<div class="live-box">
  <div>ENTRY: <span id="entryLive">--</span></div>
  <div>PNL: <span id="pnlLive">0.00</span></div>
</div>

<div id="timer"></div>

<div id="controls" style="margin-top:10px">
  <button class="btn btn-up" onclick="selectDir('UP')">UP</button>
  <button class="btn btn-down" onclick="selectDir('DOWN')">DOWN</button>
  <button id="startBtn" class="btn btn-connect btn-disabled" style="margin-top:8px" onclick="startBet()">CONFIRM BET</button>
</div>
</div>
</div>

<div id="resultModal" class="modal">
<div class="modal-content">
  <h2 id="resTitle"></h2>
  <div id="resPnL" style="font-size:32px;margin:10px 0"></div>
  <button class="btn btn-connect" onclick="closeModal()">CONTINUE</button>
</div>
</div>

<script>
let userWallet,currentBalance=100,btcPrice=0,entryPrice=0,selected=null,gameState="IDLE";
let pnlInterval;

connectBtn.onclick=async()=>{
  const acc=await ethereum.request({method:'eth_requestAccounts'});
  userWallet=acc[0];
  auth-section.style.display="none";
  app-content.style.display="block";
};

async function getPrice(){
  const r=await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
  const d=await r.json();
  btcPrice=parseFloat(d.price);
  btc-price.textContent="$"+btcPrice.toLocaleString();
}
setInterval(getPrice,2000);

function selectDir(d){
  if(gameState!=="IDLE")return;
  selected=d;
  startBtn.classList.remove('btn-disabled');
}

function startBet(){
  gameState="ACTIVE";
  entryPrice=btcPrice;
  entryLive.textContent="$"+entryPrice.toLocaleString();
  controls.style.display="none";

  let sec=60;
  pnlInterval=setInterval(()=>{
    let pnl=selected==="UP"?btcPrice-entryPrice:entryPrice-btcPrice;
    pnlLive.textContent=(pnl>=0?"+":"-")+"$"+Math.abs(pnl).toFixed(2);
    pnlLive.style.color=pnl>=0?"var(--green)":"var(--red)";
  },1000);

  const t=setInterval(()=>{
    timer.textContent=sec--+"s";
    if(sec<0){clearInterval(t);endBet();}
  },1000);
}

function endBet(){
  clearInterval(pnlInterval);
  let pnl=selected==="UP"?btcPrice-entryPrice:entryPrice-btcPrice;
  currentBalance+=pnl;
  balanceUSD.textContent="$"+currentBalance.toFixed(2);
  rewardNFTFAN.textContent=Math.floor(currentBalance)+"M";

  resTitle.textContent=pnl>=0?"WINNER":"LOSE";
  resPnL.textContent=(pnl>=0?"+":"-")+"$"+Math.abs(pnl).toFixed(2);
  resPnL.style.color=pnl>=0?"var(--green)":"var(--red)";
  resultModal.style.display="flex";
  if(pnl>=0)confetti({particleCount:120,spread:70});
}

function closeModal(){
  resultModal.style.display="none";
  controls.style.display="block";
  timer.textContent="";
  pnlLive.textContent="0.00";
  gameState="IDLE";
  selected=null;
  startBtn.classList.add('btn-disabled');
}

const ctx=document.getElementById('btcChart').getContext('2d');
let hist=[];
new Chart(ctx,{
 type:'line',
 data:{labels:new Array(20).fill(''),datasets:[{data:hist,borderColor:'#00ffff',tension:.4,pointRadius:0}]},
 options:{plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}
});
setInterval(()=>{hist.push(btcPrice);if(hist.length>20)hist.shift();},3000);
</script>

</body>
</html>
