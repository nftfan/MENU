<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Books Search</title>
  <!-- Material Icons CDN -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary: #1976d2;
      --primary-light: #42a5f5;
      --primary-dark: #1565c0;
      --accent: #ffd600;
      --bg: #181b20;
      --bg-light: #23272e;
      --text: #f2f3f7;
      --text-secondary: #bfc5d1;
      --card-bg: #23272e;
      --border: #263040;
      --shadow: 0 5px 18px 2px rgba(25,118,210,0.10);
      --book-shadow: 0 2px 10px 0 rgba(25,118,210,0.15);
      --tooltip-bg: #23272e;
    }
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 0; 
      background: var(--bg);
      color: var(--text);
    }
    .top-bar {
      display: flex;
      align-items: center;
      background: linear-gradient(90deg, var(--primary) 60%, var(--primary-light) 100%);
      padding: 0 20px;
      height: 64px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .icon-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: #fff;
      outline: none;
      margin: 0 14px;
      padding: 10px 0 4px 0;
      font-size: 32px;
      transition: color 0.18s, transform 0.18s;
      position: relative;
    }
    .icon-btn.active,
    .icon-btn:hover {
      color: var(--accent);
      transform: scale(1.15);
    }
    .icon-btn .tooltip {
      visibility: hidden;
      opacity: 0;
      width: max-content;
      background: var(--tooltip-bg);
      color: #fff;
      text-align: center;
      border-radius: 4px;
      padding: 2px 10px;
      position: absolute;
      z-index: 1;
      bottom: -32px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 13px;
      transition: opacity 0.2s;
      pointer-events: none;
    }
    .icon-btn:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
    #books-list { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 16px; 
      justify-content: center;
      margin: 24px auto 0 auto;
      max-width: 1200px;
    }
    .book {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      width: 190px;
      box-sizing: border-box;
      background: var(--card-bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.19s, border-color 0.2s;
      min-height: 300px;
      box-shadow: var(--book-shadow);
    }
    .book:hover {
      box-shadow: var(--shadow);
      border-color: var(--primary-light);
    }
    .book-title { 
      font-weight: 500; 
      margin: 10px 0 4px 0; 
      text-align: center; 
      font-size: 1.04em;
      color: var(--text);
    }
    .book-author { 
      color: var(--text-secondary); 
      font-size: 0.95em; 
      text-align: center; 
      margin-bottom: 4px;
    }
    .book-year { 
      font-size: 0.88em; 
      color: #888; 
    }
    .book-cover { 
      width: 104px; 
      height: 154px; 
      object-fit: cover; 
      border: 1px solid #393e48; 
      margin-bottom: 6px; 
      border-radius: 4px;
      background: #222;
    }
    .book-link { 
      color: inherit; 
      text-decoration: none; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      width: 100%; 
    }
    #loading { 
      text-align: center; 
      margin: 20px; 
      color: var(--primary-light);
      font-weight: 500;
    }
    @media (max-width: 600px) {
      #books-list { gap: 8px; }
      .book { width: 45vw; min-width: 140px; }
    }
    /* Scrollbar styling for dark mode */
    ::-webkit-scrollbar {
      width: 10px;
      background: #23272e;
    }
    ::-webkit-scrollbar-thumb {
      background: #263040;
      border-radius: 6px;
    }
    ::selection {
      background: var(--primary-light);
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <button class="icon-btn active" data-topic="physics" title="Physics">
      <span class="material-icons">science</span>
      <span class="tooltip">Physics</span>
    </button>
    <button class="icon-btn" data-topic="math" title="Mathematics">
      <span class="material-icons">calculate</span>
      <span class="tooltip">Mathematics</span>
    </button>
    <button class="icon-btn" data-topic="history" title="History">
      <span class="material-icons">history_edu</span>
      <span class="tooltip">History</span>
    </button>
    <button class="icon-btn" data-topic="literature" title="Literature">
      <span class="material-icons">menu_book</span>
      <span class="tooltip">Literature</span>
    </button>
    <button class="icon-btn" data-topic="computer science" title="Computer Science">
      <span class="material-icons">computer</span>
      <span class="tooltip">Computer Science</span>
    </button>
    <button class="icon-btn" data-topic="art" title="Art">
      <span class="material-icons">palette</span>
      <span class="tooltip">Art</span>
    </button>
    <button class="icon-btn" data-topic="biology" title="Biology">
      <span class="material-icons">biotech</span>
      <span class="tooltip">Biology</span>
    </button>
    <button class="icon-btn" data-topic="music" title="Music">
      <span class="material-icons">music_note</span>
      <span class="tooltip">Music</span>
    </button>
  </div>
  <div id="books-list"></div>
  <div id="loading"></div>

  <script>
    let currentPage = 1;
    let loading = false;
    let endOfResults = false;
    let currentTopic = 'physics';
    let lastQuery = '';

    function renderBooks(books) {
      let html = '';
      books.forEach(book => {
        let coverImg = book.cover_i
          ? `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg`
          : 'https://via.placeholder.com/104x154/23272e/888?text=No+Cover';
        let bookUrl = `https://openlibrary.org${book.key}`;
        html += `<div class="book">
          <a class="book-link" href="${bookUrl}" target="_blank" rel="noopener noreferrer">
            <img class="book-cover" src="${coverImg}" alt="Book cover">
            <div class="book-title">${book.title}</div>
          </a>
          <div class="book-author">${book.author_name ? book.author_name.join(', ') : 'Unknown'}</div>
          <div class="book-year">${book.first_publish_year ? 'First published: ' + book.first_publish_year : ''}</div>
        </div>`;
      });
      document.getElementById('books-list').insertAdjacentHTML('beforeend', html);
    }

    async function fetchBooks(page = 1, topic = 'physics') {
      if (loading || endOfResults) return;
      loading = true;
      document.getElementById('loading').innerText = 'Loading...';
      let query = encodeURIComponent(topic);
      lastQuery = topic;

      const response = await fetch(`https://openlibrary.org/search.json?q=${query}&page=${page}`);
      const data = await response.json();
      const books = data.docs;

      if (books.length === 0) {
        endOfResults = true;
        document.getElementById('loading').innerText = 'No more books found.';
        loading = false;
        return;
      }

      renderBooks(books);
      document.getElementById('loading').innerText = '';
      loading = false;
    }

    function resetAndFetch(topic) {
      currentPage = 1;
      endOfResults = false;
      document.getElementById('books-list').innerHTML = '';
      fetchBooks(currentPage, topic);
    }

    // Initial load
    fetchBooks(currentPage, currentTopic);

    // Infinite scroll
    window.addEventListener('scroll', () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
        if (!loading && !endOfResults) {
          currentPage += 1;
          fetchBooks(currentPage, currentTopic);
        }
      }
    });

    // Topic switching
    document.querySelectorAll('.icon-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const topic = this.getAttribute('data-topic');
        if (topic === currentTopic) return;
        document.querySelectorAll('.icon-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentTopic = topic;
        resetAndFetch(topic);
      });
    });
  </script>
</body>
</html>
